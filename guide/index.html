<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Node Setup Guide | Mostro P2P</title>
  <meta name="description" content="Complete guide to running your own Mostro P2P Bitcoin exchange node. Step-by-step setup for Docker and native builds.">
  <link rel="stylesheet" href="guide-styles.css">
  <link rel="icon" href="../assets/images/favicon.png" type="image/png">
</head>
<body>

<!-- Header -->
<header class="guide-header">
  <a href="../index.html" class="header-logo">
    <img src="../assets/images/logo.svg" alt="Mostro">
    <span>Node Guide</span>
  </a>
  <div class="header-right">
    <div class="lang-switcher">
      <a href="index.html" class="active">EN</a>
      <a href="index.es.html">ES</a>
      <a href="index.it.html">IT</a>
      <a href="index.pt.html">PT</a>
    </div>
    <button class="toc-toggle" onclick="toggleSidebar()">‚ò∞ Menu</button>
  </div>
</header>

<!-- Sidebar overlay for mobile -->
<div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

<!-- Sidebar TOC -->
<aside class="guide-sidebar" id="sidebar">
  <div class="toc-title">Table of Contents</div>
  <ul class="toc-list">
    <li><a href="#what-is-mostro">1. What is Mostro?</a></li>
    <li class="toc-sub"><a href="#why-run">Why Run a Node?</a></li>
    <li class="toc-sub"><a href="#how-it-works">How It Works</a></li>
    <li><a href="#prerequisites">2. Prerequisites</a></li>
    <li class="toc-sub"><a href="#vps">Server (VPS)</a></li>
    <li class="toc-sub"><a href="#lnd">Lightning Node (LND)</a></li>
    <li class="toc-sub"><a href="#liquidity">Liquidity</a></li>
    <li class="toc-sub"><a href="#nostr-keys">Nostr Keys</a></li>
    <li class="toc-sub"><a href="#skill-level">Skill Level</a></li>
    <li><a href="#setup">3. Step-by-Step Setup</a></li>
    <li class="toc-sub"><a href="#path-a-docker">Path A: Docker</a></li>
    <li class="toc-sub"><a href="#path-b-native">Path B: Native Build</a></li>
    <li><a href="#configuration">4. Configuration</a></li>
    <li class="toc-sub"><a href="#cfg-nostr">Nostr Keys</a></li>
    <li class="toc-sub"><a href="#cfg-fees">Fees</a></li>
    <li class="toc-sub"><a href="#cfg-limits">Order Limits</a></li>
    <li class="toc-sub"><a href="#cfg-profile">Node Profile</a></li>
    <li class="toc-sub"><a href="#cfg-timing">Timing</a></li>
    <li class="toc-sub"><a href="#cfg-antispam">Anti-Spam</a></li>
    <li class="toc-sub"><a href="#cfg-rpc">RPC Admin</a></li>
    <li><a href="#operating">5. Operating Your Node</a></li>
    <li class="toc-sub"><a href="#disputes">Disputes</a></li>
    <li class="toc-sub"><a href="#mostrix">Mostrix</a></li>
    <li class="toc-sub"><a href="#watchdog">mostro-watchdog</a></li>
    <li class="toc-sub"><a href="#monitoring">Monitoring</a></li>
    <li class="toc-sub"><a href="#updating">Updating</a></li>
    <li class="toc-sub"><a href="#backups">Backups</a></li>
    <li class="toc-sub"><a href="#trade-activity">Trade Activity</a></li>
    <li><a href="#costs">6. Costs Breakdown</a></li>
    <li><a href="#faq">7. FAQ</a></li>
    <li><a href="#security">8. Security</a></li>
    <li><a href="#troubleshooting">9. Troubleshooting</a></li>
    <li><a href="#appendix">Appendix</a></li>
  </ul>
</aside>

<!-- Main Content -->
<main class="guide-content">

<h1>Running Your Own Mostro Node</h1>
<p class="guide-version">Mostro v0.16.2 ‚Äî Community Guide ¬∑ February 2026</p>

<!-- ============================================================ -->
<h2 id="what-is-mostro">1. What is Mostro and Why Should Your Community Run One?</h2>

<h3 id="what-is-mostro-sub">What is Mostro?</h3>

<p>Mostro is a <strong>peer-to-peer Bitcoin exchange</strong> that lets people buy and sell Bitcoin using local currencies (dollars, euros, pesos ‚Äî any currency) without needing to provide identity documents (KYC). Think of it as a decentralized marketplace where buyers and sellers can trade directly.</p>

<p>It works using two technologies:</p>
<ul>
  <li><strong>Lightning Network</strong> ‚Äî a fast, low-cost Bitcoin payment layer (think of it as Bitcoin's express lane for small, quick payments)</li>
  <li><strong>Nostr</strong> ‚Äî a censorship-resistant communication protocol (think of it as a messaging system that nobody can shut down)</li>
</ul>

<p>Mostro acts as an <strong>escrow coordinator</strong> ‚Äî it holds the seller's Bitcoin in a temporary "lock box" (called a hold invoice) until the buyer confirms they've sent the local currency payment. Mostro never actually controls anyone's funds; it just holds them briefly during the trade.</p>

<h3 id="why-run">Why Would Your Community Want to Run a Mostro Node?</h3>

<ol>
  <li><strong>Fee Income</strong> ‚Äî Every trade earns you a fee (default 0.6%). If your community does $10,000 in monthly trades, that's ~$60/month in fees.</li>
  <li><strong>P2P Trading Without KYC</strong> ‚Äî Your community members can buy and sell Bitcoin without providing identity documents. Especially important in regions with unstable currencies or restrictive regulations.</li>
  <li><strong>Disputes in Your Language</strong> ‚Äî When a trade goes wrong, <em>your</em> community resolves it, in <em>your</em> language, understanding <em>your</em> local payment methods.</li>
  <li><strong>Independence</strong> ‚Äî No company can shut down your exchange. No government can pressure a single operator to close it.</li>
  <li><strong>Customization</strong> ‚Äî You choose which currencies to support, what payment methods to allow, and what fees to charge.</li>
</ol>

<h3 id="how-it-works">How Mostro Works (Simplified)</h3>

<div class="flow-diagram"><span class="step-num">1.</span> Alice wants to SELL Bitcoin for $50 USD
   <span class="arrow">‚Üí</span> She creates an order on Mostro

<span class="step-num">2.</span> Bob wants to BUY Bitcoin with $50 USD
   <span class="arrow">‚Üí</span> He sees Alice's order and takes it

<span class="step-num">3.</span> Mostro creates a "lock box" (hold invoice)
   <span class="arrow">‚Üí</span> Alice sends her Bitcoin into the lock box

<span class="step-num">4.</span> Bob sends $50 to Alice via bank transfer, Zelle, cash, etc.
   <span class="arrow">‚Üí</span> Bob clicks "Fiat Sent" in his client app

<span class="step-num">5.</span> Alice confirms she received the $50
   <span class="arrow">‚Üí</span> She clicks "Release"

<span class="step-num">6.</span> Mostro releases the Bitcoin from the lock box to Bob
   <span class="arrow">‚Üí</span> Trade complete! <span class="check">‚úì</span></div>

<p>If something goes wrong (e.g., Bob says he paid but Alice didn't receive it), either party can open a <strong>dispute</strong>, and your community's assigned arbiters investigate and resolve it.</p>

<hr>

<!-- ============================================================ -->
<h2 id="prerequisites">2. Prerequisites ‚Äî What You Need Before Starting</h2>

<h3 id="vps">2.1 A Server (VPS)</h3>

<p>A <strong>VPS</strong> (Virtual Private Server) is a computer in a data center that runs 24/7. You'll rent one to host your Mostro node.</p>

<p><strong>Minimum specifications:</strong></p>
<div class="table-wrapper">
<table>
  <thead><tr><th>Resource</th><th>Minimum</th><th>Recommended</th></tr></thead>
  <tbody>
    <tr><td>CPU</td><td>2 vCPUs (shared)</td><td>2+ vCPUs</td></tr>
    <tr><td>RAM</td><td>2 GB</td><td>4 GB</td></tr>
    <tr><td>Storage</td><td>60 GB SSD</td><td>100 GB SSD</td></tr>
    <tr><td>Bandwidth</td><td>3 TB/month</td><td>3+ TB/month</td></tr>
    <tr><td>OS</td><td>Ubuntu 22.04+ LTS</td><td>Ubuntu 24.04 LTS</td></tr>
  </tbody>
</table>
</div>

<p><strong>Estimated monthly cost:</strong> $10‚Äì$24/month.</p>

<p><strong>Popular VPS providers:</strong></p>
<ul>
  <li><a href="https://www.hostinger.com/" target="_blank" rel="noopener noreferrer">Hostinger</a> ‚Äî from ~$7/month (promo pricing; renewal rates may vary) (KVM 2: 2 vCPU, 8GB RAM, 100GB NVMe, 8TB bandwidth) ¬∑ Accepts crypto</li>
  <li><a href="https://www.hetzner.com/" target="_blank" rel="noopener noreferrer">Hetzner</a> ‚Äî ‚Ç¨3.49-8/month (CX23 from ‚Ç¨3.49, good value, EU-based)</li>
  <li><a href="https://www.digitalocean.com/" target="_blank" rel="noopener noreferrer">Digital Ocean</a> ‚Äî $24/month (4GB RAM, 2 CPUs, 80GB SSD) or $32/month (4GB RAM, 2 Intel CPUs, 120GB NVMe)</li>
  <li><a href="https://www.ovhcloud.com/" target="_blank" rel="noopener noreferrer">OVH</a> ‚Äî ~$6-12/month</li>
  <li><a href="https://www.linode.com/" target="_blank" rel="noopener noreferrer">Linode/Akamai</a> ‚Äî $12/month</li>
  <li><a href="https://www.lunanode.com/" target="_blank" rel="noopener noreferrer">Lunanode</a> ‚Äî Accepts Bitcoin payments</li>
</ul>

<div class="callout tip">
  <div class="callout-title">üí° Tip</div>
  Many VPS providers accept Bitcoin payments. Look for that option if you want to keep things consistent with the Bitcoin ethos.
</div>

<p>You need to be comfortable connecting to a server via SSH. If you've never done this, look for a tutorial on "SSH into a VPS" ‚Äî it's simpler than it sounds.</p>

<h3 id="lnd">2.2 A Lightning Network Node (LND)</h3>

<p>The Lightning Network is a "layer 2" system built on top of Bitcoin enabling fast, cheap payments. To run Mostro, you need an <strong>LND node</strong> (Lightning Network Daemon) ‚Äî the specific Lightning software that Mostro works with.</p>

<p><strong>Your options:</strong></p>
<div class="table-wrapper">
<table>
  <thead><tr><th>Option</th><th>Difficulty</th><th>Cost</th><th>Notes</th></tr></thead>
  <tbody>
    <tr><td>Use an existing LND node</td><td><span class="badge badge-easy">Easy</span></td><td>Free (if you have one)</td><td>Best if someone already runs one</td></tr>
    <tr><td>Run LND on the same VPS</td><td><span class="badge badge-hard">Hard</span></td><td>Same VPS + liquidity</td><td>Requires 4GB+ RAM VPS</td></tr>
    <tr><td>Node-in-a-box solution</td><td><span class="badge badge-medium">Medium</span></td><td>$200-600 + liquidity</td><td><a href="https://start9.com/" target="_blank" rel="noopener noreferrer">Start9</a>, <a href="https://umbrel.com/" target="_blank" rel="noopener noreferrer">Umbrel</a>, <a href="https://raspiblitz.org/" target="_blank" rel="noopener noreferrer">RaspiBlitz</a></td></tr>
    <tr><td>StartOS with Mostro package</td><td><span class="badge badge-easy">Easiest</span></td><td>$300-600 + liquidity</td><td>Start9 has a one-click Mostro package</td></tr>
    <tr><td>Use Voltage.cloud</td><td><span class="badge badge-easy">Easy</span></td><td>From ~$20/month + liquidity</td><td><a href="https://voltage.cloud/" target="_blank" rel="noopener noreferrer">Voltage</a> ‚Äî hosted LND with managed infrastructure</td></tr>
  </tbody>
</table>
</div>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Important</div>
  Mostro specifically requires <strong>LND</strong> (not CLN/Core Lightning, not Eclair, not LDK). Make sure your Lightning node runs LND.
</div>

<p><strong>What you need from your LND node:</strong></p>
<ul>
  <li>The <code>tls.cert</code> file (a security certificate)</li>
  <li>The <code>admin.macaroon</code> file (an authentication token)</li>
  <li>The gRPC address (typically <code>https://127.0.0.1:10009</code> if on the same machine)</li>
</ul>

<h3 id="liquidity">2.3 Lightning Liquidity</h3>

<p>To facilitate trades, your Lightning node needs <strong>channels</strong> with Bitcoin in them. Think of Lightning channels as pre-funded payment tunnels. The Bitcoin inside these channels is your "liquidity."</p>

<p><strong>How much do you need?</strong></p>
<div class="table-wrapper">
<table>
  <thead><tr><th>Trading Volume Target</th><th>Suggested Liquidity</th><th>Approximate BTC</th></tr></thead>
  <tbody>
    <tr><td>Small community (few trades/day)</td><td>1‚Äì5 million sats</td><td>0.01‚Äì0.05 BTC</td></tr>
    <tr><td>Medium community</td><td>5‚Äì20 million sats</td><td>0.05‚Äì0.20 BTC</td></tr>
    <tr><td>Active community</td><td>20‚Äì100 million sats</td><td>0.20‚Äì1.0 BTC</td></tr>
  </tbody>
</table>
</div>

<div class="callout tip">
  <div class="callout-title">üí° Lightning Liquidity Note</div>
  The Bitcoin in your Lightning channels is locked <strong>onchain</strong> but remains highly spendable via Lightning Network. Many services accept Lightning payments ‚Äî from coffee shops to VPS providers ‚Äî making your liquidity quite flexible for everyday use.
</div>

<p><strong>Start small, grow incrementally.</strong> Begin with enough for your community's initial needs and monitor feedback. When traders report orders failing due to insufficient capacity, that's your signal to add more. Listen to your community.</p>

<p><strong>Getting liquidity:</strong></p>
<ul>
  <li>Open channels to well-connected nodes (use <a href="https://1ml.com/" target="_blank" rel="noopener noreferrer">1ML</a> or <a href="https://amboss.space/" target="_blank" rel="noopener noreferrer">Amboss</a> to find good peers)</li>
  <li>You need both <strong>outbound</strong> capacity (to pay buyers) and <strong>inbound</strong> capacity (to receive from sellers)</li>
  <li>Getting inbound liquidity is often harder ‚Äî consider <a href="https://lightning.engineering/loop/" target="_blank" rel="noopener noreferrer">Lightning Loop</a>, <a href="https://amboss.space/magma" target="_blank" rel="noopener noreferrer">Magma</a>, or channel swap services</li>
</ul>

<h3 id="nostr-keys">2.4 Nostr Keys</h3>

<p>Your Mostro node needs its own identity on the Nostr network ‚Äî a cryptographic key pair with a public key (your node's address) and a private key (your secret).</p>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Important</div>
  Never reuse Nostr keys between Mostro instances. Each node needs its own unique identity.
</div>

<p><strong>Generating secure Nostr keys locally with rana:</strong></p>

<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Install Rust (if not already installed)</span>
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
source ~/.cargo/env

<span class="cm"># Install rana - local Nostr key generator</span>
cargo install rana

<span class="cm"># Generate a new key pair</span>
rana</code></pre>
</div>

<p>Rana will generate both your private key (nsec) and public key (npub). <strong>Save both securely!</strong> Never generate important keys like these using online services ‚Äî always use local tools like rana for security.</p>

<h3 id="skill-level">2.5 Technical Knowledge Level</h3>

<div class="table-wrapper">
<table>
  <thead><tr><th>Task</th><th>Difficulty</th><th>Skills Needed</th></tr></thead>
  <tbody>
    <tr><td>Renting a VPS</td><td><span class="badge badge-easy">Easy</span></td><td>Credit card, basic web navigation</td></tr>
    <tr><td>Connecting via SSH</td><td><span class="badge badge-easy">Easy</span></td><td>Following instructions, typing commands</td></tr>
    <tr><td>Installing Docker</td><td><span class="badge badge-medium">Medium</span></td><td>Copy-pasting commands, basic troubleshooting</td></tr>
    <tr><td>Running Mostro (Docker)</td><td><span class="badge badge-medium">Medium</span></td><td>Editing config files, understanding paths</td></tr>
    <tr><td>Running Mostro (native)</td><td><span class="badge badge-hard">Hard</span></td><td>Linux sysadmin, compiling software, systemd</td></tr>
    <tr><td>Setting up LND from scratch</td><td><span class="badge badge-hard">Hard</span></td><td>Significant Linux and networking knowledge</td></tr>
    <tr><td>Managing Lightning liquidity</td><td><span class="badge badge-hard">Hard</span></td><td>Understanding Lightning channel economics</td></tr>
  </tbody>
</table>
</div>

<p><strong>Our recommendation:</strong> If your community has someone comfortable with the Linux command line, they can handle the Docker setup (Path A). For Path B, you want someone with sysadmin experience. The Lightning node setup is the most complex part ‚Äî consider having someone experienced help, or using a node-in-a-box solution.</p>

<hr>

<!-- ============================================================ -->
<h2 id="setup">3. Step-by-Step Setup</h2>

<p>Choose your path:</p>
<ul>
  <li><strong>Path A (Docker):</strong> Simpler, fewer steps, easier updates. Recommended for most communities.</li>
  <li><strong>Path B (Native Build):</strong> More control, better for experienced sysadmins. Slightly better performance.</li>
</ul>

<p>Both paths assume you already have: ‚úÖ A VPS with Ubuntu running ¬∑ ‚úÖ SSH access ¬∑ ‚úÖ An LND node running.</p>

<!-- Path A: Docker -->
<details class="collapsible" id="path-a-docker" open>
<summary>Path A: Docker Setup (Recommended for Beginners)</summary>
<div class="collapsible-content">

<h4>Step 1: Connect to your VPS</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>ssh root@YOUR_VPS_IP_ADDRESS</code></pre>
</div>

<h4>Step 2: Update the system</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Download the latest package information</span>
apt update

<span class="cm"># Install all available updates</span>
apt upgrade -y</code></pre>
</div>

<h4>Step 3: Install Docker and Docker Compose</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Install Docker using the official convenience script</span>
curl -fsSL https://get.docker.com | sh

<span class="cm"># Verify Docker is installed</span>
docker --version
<span class="cm"># Expected: Docker version 24.x.x or newer</span>

<span class="cm"># Verify Docker Compose</span>
docker compose version
<span class="cm"># Expected: Docker Compose version v2.x.x</span></code></pre>
</div>

<h4>Step 4: Install additional tools</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>apt install -y git make</code></pre>
</div>

<h4>Step 5: Download Mostro</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>cd /opt
git clone https://github.com/MostroP2P/mostro.git
cd mostro</code></pre>
</div>

<h4>Step 6: Set up configuration files</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>cd docker
mkdir -p config
cp ../settings.tpl.toml config/settings.toml</code></pre>
</div>

<div class="callout tip">
  <div class="callout-title">üí° Changed in v0.16.2+</div>
  <ul>
    <li>No more <code>empty.mostro.db</code> ‚Äî Mostro creates the database automatically</li>
    <li><code>settings.docker.toml</code> ‚Üí <code>settings.tpl.toml</code> (template name changed)</li>
    <li>No more <code>.env</code> file ‚Äî environment variables passed directly to build command</li>
  </ul>
</div>

<h4>Step 7: Edit the configuration file</h4>

<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>nano config/settings.toml</code></pre>
</div>

<p>You <strong>must</strong> change these key settings:</p>
<ol>
  <li><strong><code>lnd_grpc_host</code></strong> ‚Äî The address of your LND node:
    <ul>
      <li>Same machine: <code>'https://host.docker.internal:10009'</code></li>
      <li>Different machine: <code>'https://YOUR_LND_IP:10009'</code></li>
    </ul>
  </li>
  <li><strong><code>lnd_cert_file</code></strong> and <strong><code>lnd_macaroon_file</code></strong> ‚Äî Set these to:
    <ul>
      <li><code>lnd_cert_file = '/config/lnd/tls.cert'</code></li>
      <li><code>lnd_macaroon_file = '/config/lnd/admin.macaroon'</code></li>
    </ul>
  </li>
  <li><strong><code>nsec_privkey</code></strong> ‚Äî Your Mostro's Nostr private key (e.g., <code>YOUR_NSEC_KEY</code>). Generate locally using <code>rana</code> (see section 2.4). <strong>Save both nsec and npub keys safely!</strong></li>
  <li><strong><code>relays</code></strong> ‚Äî The Nostr relays your node connects to.</li>
  <li><strong><code>url</code></strong> (in [database] section) ‚Äî Set to: <code>"sqlite:///config/mostro.db"</code></li>
</ol>

<p><strong>Other settings you'll likely want to change:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>[mostro]
fee = 0.006                    <span class="cm"># 0.6% trading fee</span>
max_order_amount = 1000000     <span class="cm"># Max order in sats (~$400-500)</span>
min_payment_amount = 100       <span class="cm"># Min order in sats</span>
fiat_currencies_accepted = ['USD', 'EUR']  <span class="cm"># Your currencies</span>

[database]
url = "sqlite:///config/mostro.db"  <span class="cm"># Database path inside container</span></code></pre>
</div>

<p>Save: <code>Ctrl+X</code>, then <code>Y</code>, then <code>Enter</code>.</p>

<h4>Step 8: Build the Docker image</h4>

<p>You need to provide the <code>LND_CERT_FILE</code> and <code>LND_MACAROON_FILE</code> environment variables pointing to your LND files. These will be copied to <code>config/lnd/</code> during the build.</p>

<div class="callout warning">
  <div class="callout-title">üìÅ Working Directory</div>
  Return to the repository root directory before running make commands:
</div>

<p><strong>Linux/macOS:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>cd ..
LND_CERT_FILE=~/.polar/networks/1/volumes/lnd/alice/tls.cert \
LND_MACAROON_FILE=~/.polar/networks/1/volumes/lnd/alice/data/chain/bitcoin/regtest/admin.macaroon \
make docker-build</code></pre>
</div>

<p><strong>Windows PowerShell:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>powershell</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>cd ..
$env:LND_CERT_FILE="C:\Users\YourUser\.polar\networks\1\volumes\lnd\alice\tls.cert"
$env:LND_MACAROON_FILE="C:\Users\YourUser\.polar\networks\1\volumes\lnd\alice\data\chain\bitcoin\regtest\admin.macaroon"
make docker-build</code></pre>
</div>

<p><strong>Alternative:</strong> Export the variables for your session:</p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>cd ..
export LND_CERT_FILE=~/.polar/networks/1/volumes/lnd/alice/tls.cert
export LND_MACAROON_FILE=~/.polar/networks/1/volumes/lnd/alice/data/chain/bitcoin/regtest/admin.macaroon
make docker-build</code></pre>
</div>

<p>If LND is on the <strong>same machine</strong>, typical paths are:</p>
<ul>
  <li><code>/root/.lnd/tls.cert</code></li>
  <li><code>/root/.lnd/data/chain/bitcoin/mainnet/admin.macaroon</code></li>
</ul>

<p>If LND is on a <strong>different machine</strong>, copy the files to your local system first, then point the environment variables to those local copies.</p>

<h4>Step 9: Start Mostro</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Start Mostro and local Nostr relay</span>
make docker-up</code></pre>
</div>

<p>Check if everything is running:</p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>docker compose -f compose.yml ps</code></pre>
</div>

<h4>Step 10: Check the logs</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>docker compose -f compose.yml logs -f mostro</code></pre>
</div>

<p>Look for these messages:</p>
<ul>
  <li><code>Settings correctly loaded</code> ‚Äî Configuration is valid</li>
  <li><code>Connected to LND</code> ‚Äî Lightning connection successful</li>
  <li><code>Connected to relay</code> ‚Äî Nostr relay established</li>
</ul>

<h4>Stopping and restarting</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>make docker-down   <span class="cm"># Stop</span>
make docker-up     <span class="cm"># Start</span></code></pre>
</div>

<p>üéâ <strong>Congratulations!</strong> If you see successful connections in the logs, your Mostro node is running!</p>

<hr>

<h4>Troubleshooting Common Docker Issues</h4>

<details class="collapsible" id="docker-troubleshooting">
<summary><strong>Common Issues and Solutions</strong></summary>
<div class="collapsible-content">

<h5>‚ùå Error: Permission denied (os error 13)</h5>

<div class="callout warning">
  <div class="callout-title">üõ†Ô∏è Database Permission Issue</div>
  SQLite needs write permissions to both the database file and the parent directory to create temporary files (<code>.db-wal</code>, <code>.db-shm</code>).
</div>

<p><strong>Quick Fix:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Fix permissions before starting</span>
sudo chown -R 1000:1000 ./config/
sudo chmod -R 755 ./config/

<span class="cm"># Then start normally</span>
make docker-up</code></pre>
</div>

<p><strong>Permanent Fix in docker-compose.yml:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>yaml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>services:
  mostro:
    # ... existing config ...
    user: "1000:1000"  # Run as non-root user
    volumes:
      - ./config:/config:rw  # Ensure read-write access</code></pre>
</div>

<h5>‚ùå Error: No such device or address (os error 6)</h5>

<div class="callout warning">
  <div class="callout-title">üñ•Ô∏è Database Password Prompt Issue</div>
  Mostro prompts for database password interactively, but Docker containers don't have TTY by default.
</div>

<p><strong>Option 1: Skip Database Encryption (Fastest for Testing)</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Set empty password to skip encryption</span>
MOSTRO_DB_PASSWORD="" make docker-up</code></pre>
</div>

<p><strong>Option 2: Set Database Password via Environment Variable</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Set password securely</span>
MOSTRO_DB_PASSWORD="your-secure-password" make docker-up</code></pre>
</div>

<p><strong>Option 3: Enable Interactive Mode in docker-compose.yml</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>yaml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>services:
  mostro:
    # ... existing config ...
    tty: true        # Enable TTY for interactive prompts
    stdin_open: true # Enable STDIN
    environment:
      - MOSTRO_DB_PASSWORD=${DB_PASSWORD:-}  # Optional: set via .env</code></pre>
</div>

<h5>‚ùå Database file creation issues</h5>

<p><strong>Ensure correct directory structure:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Create directory with proper permissions</span>
mkdir -p docker/config
sudo chown -R $(id -u):$(id -g) docker/config
chmod 755 docker/config

<span class="cm"># Verify permissions</span>
ls -la docker/config/</code></pre>
</div>

<p><strong>Debug steps:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Check container user</span>
docker compose exec mostro whoami

<span class="cm"># Check mounted directory permissions inside container</span>
docker compose exec mostro ls -la /config

<span class="cm"># Fix permissions from host (safer than inside container)</span>
sudo chown -R 1000:1000 ./config/</code></pre>
</div>

</div>
</details>

<hr>

<h4>Alternative: Running from Docker Hub (No Build Required)</h4>

<div class="callout tip">
  <div class="callout-title">üöÄ New in v0.16.2+</div>
  You can now run Mostro directly from Docker Hub without cloning the repository or building locally. Perfect for VPS deployments!
</div>

<p><strong>Step-by-step for VPS deployment:</strong></p>

<h5>1. Create a config directory</h5>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>mkdir -p ~/mostro-config/lnd</code></pre>
</div>

<h5>2. Get the settings template</h5>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>curl -sL https://raw.githubusercontent.com/MostroP2P/mostro/main/settings.tpl.toml -o ~/mostro-config/settings.toml</code></pre>
</div>

<h5>3. Copy your LND credentials</h5>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>cp /path/to/your/tls.cert ~/mostro-config/lnd/tls.cert
cp /path/to/your/admin.macaroon ~/mostro-config/lnd/admin.macaroon</code></pre>
</div>

<h5>4. Edit the configuration</h5>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>nano ~/mostro-config/settings.toml</code></pre>
</div>

<p><strong>Required changes for Docker Hub deployment:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>[lightning]
lnd_cert_file = '/config/lnd/tls.cert'
lnd_macaroon_file = '/config/lnd/admin.macaroon'
lnd_grpc_host = 'https://host.docker.internal:10009'  <span class="cm"># If LND on same VPS</span>
<span class="cm"># Or use 'https://YOUR_LND_IP:10009' if LND on different server</span>

[database]
url = "sqlite:///config/mostro.db"

[nostr]
nsec_privkey = 'YOUR_NSEC_KEY_HERE'
relays = ['wss://relay.mostro.network', 'wss://nos.lol']</code></pre>
</div>

<h5>5. Run the container</h5>

<p><strong>If LND is on the same VPS:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>docker run -d --name mostro \
  --restart unless-stopped \
  --add-host=host.docker.internal:host-gateway \
  -v ~/mostro-config:/config \
  mostrop2p/mostro:latest</code></pre>
</div>

<p><strong>If LND is on a different server:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>docker run -d --name mostro \
  --restart unless-stopped \
  -v ~/mostro-config:/config \
  mostrop2p/mostro:latest</code></pre>
</div>

<h5>6. Check the logs</h5>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>docker logs -f mostro</code></pre>
</div>

<p><strong>Advantages of Docker Hub deployment:</strong></p>
<ul>
  <li>‚úÖ No build time (5-15 minutes saved)</li>
  <li>‚úÖ No need to clone repository</li>
  <li>‚úÖ Smaller VPS storage requirements</li>
  <li>‚úÖ Automatic updates with <code>docker pull mostrop2p/mostro:latest</code></li>
  <li>‚úÖ Perfect for production VPS deployments</li>
</ul>

<div class="callout warning">
  <div class="callout-title">üîí Security Note</div>
  When using a specific version tag (e.g., <code>mostrop2p/mostro:v0.16.2</code>) instead of <code>:latest</code>, you have better control over updates and can test new versions before deploying.
</div>

</div>
</details>

<!-- Path B: Native -->
<details class="collapsible" id="path-b-native">
<summary>Path B: Native Build (For Technical Operators)</summary>
<div class="collapsible-content">

<h4>Step 1: Connect and update</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>ssh root@YOUR_VPS_IP_ADDRESS
apt update
apt upgrade -y</code></pre>
</div>

<h4>Step 2: Install Rust</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Install Rust (press 1 when asked)</span>
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

<span class="cm"># Make Rust available in current session</span>
source /root/.cargo/env

<span class="cm"># Verify</span>
rustc --version   <span class="cm"># Expected: rustc 1.86.0+</span>
cargo --version   <span class="cm"># Expected: cargo 1.86.0+</span></code></pre>
</div>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Important</div>
  Do NOT install Rust via <code>apt install rustc</code>. Always use <code>rustup</code> as shown above. The system package is often outdated and will cause compilation errors.
</div>

<h4>Step 3: Install build dependencies</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>apt install -y cmake build-essential libsqlite3-dev libssl-dev pkg-config git sqlite3 protobuf-compiler</code></pre>
</div>

<h4>Step 4: Download and compile Mostro</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>cd /opt
git clone https://github.com/MostroP2P/mostro.git
cd mostro

<span class="cm"># Compile in release mode (10-20 minutes on a small VPS)</span>
cargo build --release</code></pre>
</div>

<div class="callout tip">
  <div class="callout-title">üí° Tip</div>
  If compilation fails due to low RAM, add swap space:
  <div class="code-block" style="margin-top:10px">
    <pre><code>fallocate -l 2G /swapfile
chmod 600 /swapfile
mkswap /swapfile
swapon /swapfile</code></pre>
  </div>
</div>

<h4>Step 5: Install the binary</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>install target/release/mostrod /usr/local/bin
mostrod --version</code></pre>
</div>

<h4>Step 6: Initialize the database</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>cargo install sqlx-cli --version 0.6.2
./init_db.sh</code></pre>
</div>

<h4>Step 7: Clean up build files</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>cargo clean  <span class="cm"># Saves 2+ GB of disk space</span></code></pre>
</div>

<h4>Step 8: Create a dedicated user</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>adduser --disabled-login mostro</code></pre>
</div>

<h4>Step 9: Configure Mostro</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>mkdir -p /opt/mostro
cp /opt/mostro/mostro/settings.tpl.toml /opt/mostro/settings.toml
nano /opt/mostro/settings.toml</code></pre>
</div>

<p>Edit the same settings as Path A Step 7: <code>lnd_cert_file</code>, <code>lnd_macaroon_file</code>, <code>lnd_grpc_host</code>, <code>nsec_privkey</code>, <code>relays</code>, <code>fee</code>, <code>fiat_currencies_accepted</code>, etc.</p>

<h4>Step 10: Test run</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>/usr/local/bin/mostrod -d /opt/mostro</code></pre>
</div>
<p>If it connects to LND and relays successfully, press <code>Ctrl+C</code> to stop.</p>

<h4>Step 11: Set file permissions</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>chown -R mostro:mostro /opt/mostro</code></pre>
</div>

<h4>Step 12: Set up as a system service</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>nano /etc/systemd/system/mostro.service</code></pre>
</div>

<p>Paste this content:</p>
<div class="code-block">
  <div class="code-block-header"><span>ini</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>[Unit]
Description=Mostro daemon
After=network.target

[Service]
Type=simple
User=mostro
WorkingDirectory=/home/mostro
Environment=RUST_LOG=info
ExecStart=/usr/local/bin/mostrod -d /opt/mostro
Restart=on-failure

[Install]
WantedBy=multi-user.target</code></pre>
</div>

<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>systemctl daemon-reload
systemctl enable mostro.service
systemctl start mostro.service
systemctl status mostro.service</code></pre>
</div>

<h4>Step 13: Verify</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>ps aux | grep mostrod
journalctl -u mostro -f</code></pre>
</div>

<p>üéâ <strong>Congratulations!</strong> Your Mostro node is running as a system service and will automatically restart after reboots.</p>

</div>
</details>

<hr>

<!-- ============================================================ -->
<h2 id="configuration">4. Configuration In Depth</h2>

<p>The <code>settings.toml</code> file controls everything about your Mostro node.</p>

<h3 id="cfg-nostr">4.1 Nostr Keys ‚Äî Your Node's Identity</h3>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>[nostr]
nsec_privkey = 'YOUR_NSEC_PRIVATE_KEY'
relays = [
  'wss://relay.mostro.network',
  'wss://nos.lol',
  'wss://relay.nostr.band'
]</code></pre>
</div>

<p><strong>Generating Nostr keys:</strong></p>
<ul>
  <li><strong>rana</strong> (CLI): <code>cargo install rana && rana</code> ‚Äî <strong>Recommended:</strong> local, secure, supports vanity key generation</li>
  <li>Any Nostr client (Damus, Amethyst, etc.) ‚Äî for less critical use cases</li>
</ul>

<div class="callout warning">
  <div class="callout-title">üîí Security Note</div>
  For critical applications like Mostro nodes, always generate keys locally using tools like <code>rana</code>. Never use online key generators for important infrastructure.
</div>

<p><strong>Which relays to use?</strong></p>
<ul>
  <li><code>wss://relay.mostro.network</code> ‚Äî Mostro's own relay, recommended</li>
  <li><code>wss://nos.lol</code> ‚Äî Reliable, well-connected relay</li>
  <li>Add 3‚Äì5 relays for reliability. More relays = better availability but more bandwidth.</li>
</ul>

<div class="callout tip">
  <div class="callout-title">üí° Tip</div>
  You can also run your own Nostr relay alongside Mostro (Docker setup includes one by default).
</div>

<h3 id="cfg-fees">4.2 Fees ‚Äî How You Earn Revenue</h3>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>[mostro]
fee = 0.006
dev_fee_percentage = 0.30</code></pre>
</div>

<p><strong>Trading fee (<code>fee</code>):</strong> Percentage charged per trade, split between buyer and seller.</p>
<ul>
  <li><code>0.006</code> = 0.6% (each party pays 0.3%)</li>
  <li><code>0.01</code> = 1.0% (each party pays 0.5%)</li>
  <li><code>0</code> = free (good for growing your user base)</li>
</ul>

<p><strong>Example:</strong> On a 100,000 sat trade with <code>fee = 0.006</code>: Buyer pays 300 sats, Seller pays 300 sats, your node earns 600 sats total.</p>

<p><strong>Development fee (<code>dev_fee_percentage</code>):</strong> A percentage of <em>your</em> fee earnings that goes to Mostro development.</p>
<ul>
  <li><code>0.30</code> = 30% (default) ‚Äî out of 600 sats, 180 go to Mostro dev fund</li>
  <li>Minimum: 10% (<code>0.10</code>), Maximum: 100% (<code>1.0</code>)</li>
  <li>Paid by your node from its earnings, not charged to users</li>
  <li>All dev fee payments are publicly auditable via Nostr events (kind 8383)</li>
</ul>

<div class="callout note">
  <div class="callout-title">üìù Note</div>
  Setting <code>dev_fee_percentage</code> below <code>0.10</code> will prevent Mostro from starting. This minimum ensures sustainable development funding.
</div>

<h3 id="cfg-limits">4.3 Order Limits and Currencies</h3>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>[mostro]
max_order_amount = 1000000
min_payment_amount = 100
fiat_currencies_accepted = ['USD', 'EUR', 'ARS', 'CUP']</code></pre>
</div>

<ul>
  <li><strong><code>max_order_amount</code>:</strong> Largest trade in satoshis. Set based on your Lightning channel capacity. Start conservative.</li>
  <li><strong><code>min_payment_amount</code>:</strong> Minimum trade in satoshis. 1,000 or 10,000 is more practical than 100.</li>
  <li><strong><code>fiat_currencies_accepted</code>:</strong> Use <a href="https://en.wikipedia.org/wiki/ISO_4217" target="_blank" rel="noopener noreferrer">ISO 4217 codes</a>. Empty array <code>[]</code> accepts all currencies.</li>
</ul>

<h3 id="cfg-profile">4.4 Node Profile (Optional but Recommended)</h3>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>[mostro]
name = "LatAm Mostro"
about = "P2P Bitcoin exchange for Latin America. Spanish support."
picture = "https://example.com/your-logo.png"
website = "https://your-community-site.com"</code></pre>
</div>

<p>These set your Mostro's profile on Nostr (NIP-01 kind 0 metadata). Clients display this so users know which Mostro they're trading on.</p>

<h3 id="cfg-timing">4.5 Timing and Expiration</h3>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>[mostro]
expiration_hours = 24
expiration_seconds = 900
hold_invoice_expiration_window = 300</code></pre>
</div>

<ul>
  <li><strong><code>expiration_hours</code>:</strong> How long an order stays open (24h default)</li>
  <li><strong><code>expiration_seconds</code>:</strong> Time for taker to complete action (900s = 15 min)</li>
  <li><strong><code>hold_invoice_expiration_window</code>:</strong> Hold invoice validity (300s = 5 min)</li>
</ul>

<h3 id="cfg-antispam">4.6 Anti-Spam</h3>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>[mostro]
pow = 0</code></pre>
</div>

<p><strong>Proof of Work:</strong> <code>0</code> = disabled; <code>10-20</code> = moderate (recommended if you experience spam). Start with <code>0</code>.</p>

<h3 id="cfg-rpc">4.7 RPC Admin Interface (Optional)</h3>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>[rpc]
enabled = false
listen_address = "127.0.0.1"
port = 50051</code></pre>
</div>

<p>Enable for admin tools like MostriX (terminal UI) for dispute resolution.</p>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Security</div>
  If you enable RPC, keep <code>listen_address</code> as <code>"127.0.0.1"</code> (localhost only). Never expose this to the public internet.
</div>

<hr>

<!-- ============================================================ -->
<h2 id="operating">5. Operating Your Mostro Node</h2>

<h3 id="disputes">5.1 How Disputes Work</h3>

<p>Disputes are your most important operational responsibility.</p>

<p><strong>When do disputes happen?</strong></p>
<ul>
  <li>Buyer claims they sent payment, seller says they didn't receive it</li>
  <li>Seller refuses to release Bitcoin after receiving payment</li>
  <li>Either party becomes unresponsive</li>
</ul>

<p><strong>The dispute process:</strong></p>
<ol>
  <li><strong>User opens a dispute</strong> ‚Äî Either party clicks "Dispute" in their client</li>
  <li><strong>Mostro flags the order</strong> ‚Äî Status changes to "Dispute", funds remain locked</li>
  <li><strong>Arbiter takes the case</strong> ‚Äî An admin (arbiter/solver) assigned to your node investigates</li>
  <li><strong>Investigation</strong> ‚Äî Communicates with both parties, requests evidence</li>
  <li><strong>Resolution</strong> ‚Äî Arbiter decides: settle to seller, or cancel/refund to buyer</li>
</ol>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Important</div>
  Choose arbiters carefully. They have power to decide where locked funds go. Pick trusted, impartial community members. Having 2‚Äì3 arbiters is recommended.
</div>

<h3 id="mostrix">5.2 Mostrix ‚Äî Your Admin Tool for Dispute Resolution</h3>

<p><a href="https://github.com/MostroP2P/mostrix" target="_blank" rel="noopener noreferrer"><strong>Mostrix</strong></a> is a terminal-based (TUI) client for Mostro. It's currently the <strong>only tool available for dispute resolution</strong> by node operators. If you run a Mostro node, you need Mostrix.</p>

<p><strong>What it does:</strong></p>
<ul>
  <li>Browse and interact with orders on your Mostro node</li>
  <li><strong>Take disputes</strong> ‚Äî claim a dispute so other admins know you're handling it</li>
  <li><strong>Chat with both parties</strong> ‚Äî communicate with buyer and seller in a split-view chat</li>
  <li><strong>Resolve disputes</strong> ‚Äî "Pay Buyer" (release sats to buyer) or "Refund Seller" (return sats to seller)</li>
  <li><strong>Manage solvers</strong> ‚Äî add other dispute resolvers from the admin interface</li>
</ul>

<h4>Installing Mostrix</h4>
<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Prerequisite: Rust/Cargo required</div>
  Mostrix must be compiled from source. If you followed Path A (Docker), you may not have Rust installed. Follow <a href="#step-2-install-rust">Path B, Step 2</a> to install Rust via rustup before proceeding.
</div>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Install dependencies (Ubuntu/Debian)</span>
sudo apt update
sudo apt install -y cmake build-essential pkg-config

<span class="cm"># Clone and build</span>
git clone https://github.com/MostroP2P/mostrix.git
cd mostrix
cargo build --release

<span class="cm"># Run</span>
cargo run</code></pre>
</div>

<p>On first run, Mostrix creates <code>~/.mostrix/settings.toml</code>. Edit this file to configure it.</p>

<h4>Configuring Mostrix for Admin Mode</h4>
<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Your Mostro node's public key (hex format)</span>
mostro_pubkey = "YOUR_MOSTRO_PUBKEY_HEX"

<span class="cm"># Your personal Nostr private key</span>
nsec_privkey = "nsec1your_personal_key"

<span class="cm"># Your ADMIN private key ‚Äî must match a solver key registered on the Mostro node</span>
admin_privkey = "nsec1your_admin_key"

<span class="cm"># The relays your Mostro node uses</span>
relays = [
  "wss://relay.mostro.network",
  "wss://nos.lol",
  "wss://relay.nostr.band"
]

<span class="cm"># Fiat currencies you want to see</span>
currencies = ["USD", "EUR", "ARS"]

<span class="cm"># IMPORTANT: Set to "admin" to enable dispute resolution features</span>
user_mode = "admin"</code></pre>
</div>

<div class="callout tip">
  <div class="callout-title">üí° Key distinction</div>
  <code>nsec_privkey</code> is your personal Nostr key (for signing events). <code>admin_privkey</code> is the key that grants admin privileges ‚Äî it must be registered as a solver on the Mostro node.
</div>

<h4>Resolving Disputes with Mostrix</h4>
<ol>
  <li><strong>Disputes Pending tab</strong> ‚Äî Shows all disputes with status "Initiated". Select one and press <strong>Enter</strong> to take it (other admins will see you've claimed it).</li>
  <li><strong>Disputes in Progress tab</strong> ‚Äî Your workspace. Each dispute shows:
    <ul>
      <li>Full dispute info (buyer, seller, amounts, currency, ratings)</li>
      <li>Split chat view ‚Äî press <strong>Tab</strong> to switch between buyer and seller chat</li>
      <li>Press <strong>Shift+I</strong> to enable chat input, type your message</li>
      <li>Use <strong>PageUp/PageDown</strong> to scroll, <strong>End</strong> to jump to latest</li>
    </ul>
  </li>
  <li><strong>Finalize</strong> ‚Äî Press <strong>Shift+F</strong> to open the finalization popup:
    <ul>
      <li><strong>Pay Buyer</strong> ‚Äî Release the locked sats to the buyer (use when seller received fiat but won't release)</li>
      <li><strong>Refund Seller</strong> ‚Äî Cancel the hold invoice, returning sats to seller (use when buyer didn't actually pay)</li>
      <li><strong>Exit</strong> ‚Äî Close without action if you need more time</li>
    </ul>
  </li>
  <li>Once finalized, the dispute is closed and cannot be modified.</li>
</ol>

<div class="callout note">
  <div class="callout-title">üìù Note</div>
  Mostrix is still work in progress. Some features like peer-to-peer chat and cooperative cancellation are not yet implemented. But the core dispute resolution flow is fully functional.
</div>

<h3 id="watchdog">5.3 mostro-watchdog ‚Äî Dispute Notifications on Telegram</h3>

<p><a href="https://github.com/MostroP2P/mostro-watchdog" target="_blank" rel="noopener noreferrer"><strong>mostro-watchdog</strong></a> is a notification bot that monitors your Mostro node for disputes and sends instant alerts to a Telegram group. This is essential for fast response times ‚Äî you don't want to be constantly watching Mostrix waiting for disputes.</p>

<p><strong>How it works:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>Flow</span></div>
  <pre><code>Mostro daemon ‚Üí Nostr (kind 38386) ‚Üí mostro-watchdog ‚Üí Telegram alert üö®</code></pre>
</div>

<p>When a user opens a dispute, your admin Telegram group gets an instant notification like:</p>
<div class="code-block">
  <div class="code-block-header"><span>Telegram alert</span></div>
  <pre><code>üö® NEW DISPUTE

üìã Dispute ID: abc123def456
üë§ Initiated by: buyer
‚è∞ Time: 2026-02-11 18:30:00 UTC

‚ö° Please take this dispute in Mostrix or your admin client.</code></pre>
</div>

<h4>Installing mostro-watchdog</h4>
<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Prerequisite: Rust/Cargo required</div>
  Like Mostrix, mostro-watchdog must be compiled from source. Ensure Rust is installed (<a href="#step-2-install-rust">Path B, Step 2</a>).
</div>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>git clone https://github.com/MostroP2P/mostro-watchdog.git
cd mostro-watchdog
cargo build --release</code></pre>
</div>

<h4>Configuring mostro-watchdog</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>cp config.example.toml config.toml
nano config.toml</code></pre>
</div>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>[mostro]
<span class="cm"># Your Mostro daemon's Nostr public key</span>
pubkey = "YOUR_MOSTRO_PUBKEY"

[nostr]
<span class="cm"># The same relays your Mostro daemon uses</span>
relays = ["wss://relay.mostro.network", "wss://nos.lol", "wss://relay.nostr.band"]

[telegram]
<span class="cm"># Get this from @BotFather on Telegram</span>
bot_token = "YOUR_BOT_TOKEN"

<span class="cm"># The Telegram group/channel ID for admin alerts</span>
chat_id = "YOUR_CHAT_ID"</code></pre>
</div>

<p><strong>Setting up the Telegram bot:</strong></p>
<ol>
  <li>Message <a href="https://t.me/BotFather" target="_blank" rel="noopener noreferrer">@BotFather</a> on Telegram ‚Üí <code>/newbot</code> ‚Üí follow instructions</li>
  <li>Copy the bot token to <code>config.toml</code></li>
  <li>Create a <strong>private Telegram group</strong> for your admin team</li>
  <li>Add the bot to the group</li>
  <li>Get the chat ID (send a message in the group, then check <code>https://api.telegram.org/bot&lt;YOUR_TOKEN&gt;/getUpdates</code>)</li>
</ol>

<h4>Running mostro-watchdog</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Run with default config</span>
./target/release/mostro-watchdog

<span class="cm"># Custom config path</span>
./target/release/mostro-watchdog /path/to/config.toml

<span class="cm"># With debug logging</span>
RUST_LOG=mostro_watchdog=debug ./target/release/mostro-watchdog</code></pre>
</div>

<div class="callout tip">
  <div class="callout-title">üí° Tip</div>
  Run mostro-watchdog as a systemd service (same as Mostro) so it starts automatically and runs 24/7. Your admins should never miss a dispute notification.
</div>

<h4>The Full Dispute Workflow</h4>
<p>Putting it all together, the complete workflow for a node operator is:</p>
<ol>
  <li><strong>mostro-watchdog</strong> detects a new dispute ‚Üí sends Telegram alert to your admin group</li>
  <li>Admin sees the alert on their phone/desktop</li>
  <li>Admin opens <strong>Mostrix</strong> in admin mode</li>
  <li>Admin goes to <strong>Disputes Pending</strong> ‚Üí takes the dispute</li>
  <li>Admin investigates via chat with buyer and seller in <strong>Disputes in Progress</strong></li>
  <li>Admin resolves with <strong>Pay Buyer</strong> or <strong>Refund Seller</strong></li>
  <li>Done ‚Äî dispute closed, users notified automatically</li>
</ol>

<p>This workflow ensures fast response times and clear accountability.</p>

<h3 id="monitoring">5.4 Monitoring Uptime</h3>

<p>Your node needs to be running 24/7.</p>

<div class="code-block">
  <div class="code-block-header"><span>bash ‚Äî Native</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>systemctl status mostro.service
journalctl -u mostro -f
journalctl -u mostro | grep -E "(error|warn|connected)" --ignore-case</code></pre>
</div>

<div class="code-block">
  <div class="code-block-header"><span>bash ‚Äî Docker</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>docker compose -f /opt/mostro/docker/compose.yml ps
docker compose -f /opt/mostro/docker/compose.yml logs -f mostro</code></pre>
</div>

<p><strong>Verify from outside:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Install tools (requires Rust) and jq for JSON formatting</span>
cargo install nostreq nostcat
apt install -y jq

<span class="cm"># Use your Mostro's 64-char hex pubkey (not npub format)</span>
nostreq --kinds 38383 --limit 1 --authors YOUR_MOSTRO_HEX_PUBKEY | nostcat --stream wss://nos.lol | jq</code></pre>
</div>

<div class="callout tip">
  <div class="callout-title">üí° Pro tip</div>
  Set up a simple uptime monitor using <a href="https://uptimerobot.com/" target="_blank" rel="noopener noreferrer">UptimeRobot</a> (free tier) or a cron job that alerts you if Mostro goes down.
</div>

<h3 id="updating">5.5 Updating Mostro</h3>

<details class="collapsible">
<summary>Docker update</summary>
<div class="collapsible-content">
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>cd /opt/mostro
git pull origin main
make docker-build
make docker-down
make docker-up</code></pre>
</div>
</div>
</details>

<details class="collapsible">
<summary>Native build update</summary>
<div class="collapsible-content">
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>cd /opt/mostro
git pull origin main
cargo build --release
install target/release/mostrod /usr/local/bin
cargo clean
cargo install sqlx-cli --version 0.6.2
sqlx migrate run
systemctl restart mostro.service</code></pre>
</div>
</div>
</details>

<div class="callout tip">
  <div class="callout-title">üí° Tip</div>
  Always backup your database before updating.
</div>

<h3 id="backups">5.6 Backups</h3>

<p>Critical files to back up: <code>settings.toml</code> (contains your Nostr private key!) and <code>mostro.db</code> (order history, reputations).</p>

<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Manual backup ‚Äî Docker (repo-based build):</span>
mkdir -p /root/mostro-backups
cp /opt/mostro/docker/config/settings.toml /root/mostro-backups/settings.toml.$(date +%Y%m%d)
cp /opt/mostro/docker/config/mostro.db /root/mostro-backups/mostro.db.$(date +%Y%m%d)

<span class="cm"># Manual backup ‚Äî Docker Hub deployment:</span>
cp ~/mostro-config/settings.toml /root/mostro-backups/settings.toml.$(date +%Y%m%d)
cp ~/mostro-config/mostro.db /root/mostro-backups/mostro.db.$(date +%Y%m%d)

<span class="cm"># Manual backup ‚Äî Native:</span>
cp /opt/mostro/settings.toml /root/mostro-backups/settings.toml.$(date +%Y%m%d)
cp /opt/mostro/mostro.db /root/mostro-backups/mostro.db.$(date +%Y%m%d)</code></pre>
</div>

<p><strong>Automated daily backup</strong> (add to crontab with <code>crontab -e</code>):</p>
<div class="code-block">
  <div class="code-block-header"><span>cron</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>0 3 * * * cp /opt/mostro/mostro.db /root/mostro-backups/mostro.db.$(date +\%Y\%m\%d)</code></pre>
</div>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Critical</div>
  Your <code>nsec_privkey</code> in <code>settings.toml</code> IS your node's identity. If you lose it, you lose your reputation and all users must reconnect to a new identity. <strong>Store a copy offline.</strong>
</div>

<h3 id="trade-activity">5.7 Checking Trade Activity</h3>

<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code><span class="cm"># Count all orders</span>
sqlite3 /path/to/mostro.db "SELECT COUNT(*) FROM orders;"

<span class="cm"># Recent successful trades</span>
sqlite3 /path/to/mostro.db "SELECT id, fiat_amount, fiat_code, amount, status, created_at FROM orders WHERE status = 'success' ORDER BY created_at DESC LIMIT 10;"

<span class="cm"># Pending orders</span>
sqlite3 /path/to/mostro.db "SELECT id, fiat_amount, fiat_code, status FROM orders WHERE status = 'pending';"

<span class="cm"># Total fee revenue</span>
sqlite3 /path/to/mostro.db "SELECT SUM(fee * 2) as total_fees_sats FROM orders WHERE status = 'success';"</code></pre>
</div>

<hr>

<!-- ============================================================ -->
<h2 id="costs">6. Costs Breakdown</h2>

<h3>Monthly Operating Costs</h3>
<div class="table-wrapper">
<table>
  <thead><tr><th>Item</th><th>Monthly Cost</th><th>Notes</th></tr></thead>
  <tbody>
    <tr><td>VPS (server)</td><td>$10‚Äì24</td><td>Depends on provider and specs</td></tr>
    <tr><td>Domain name (optional)</td><td>$1‚Äì2</td><td>For a website/identity</td></tr>
    <tr><td>Lightning channel on-chain fees</td><td>Variable</td><td>Opening/closing channels</td></tr>
    <tr><td><strong>Total monthly</strong></td><td><strong>$11‚Äì26</strong></td><td>Excluding Lightning liquidity</td></tr>
  </tbody>
</table>
</div>

<h3>One-Time / Capital Costs</h3>
<div class="table-wrapper">
<table>
  <thead><tr><th>Item</th><th>Cost</th><th>Notes</th></tr></thead>
  <tbody>
    <tr><td>Lightning liquidity</td><td>0.01‚Äì1.0+ BTC</td><td>Locked in channels; recovered on close</td></tr>
    <tr><td>Node hardware (if self-hosting)</td><td>$0‚Äì600</td><td>Free if using VPS; $300-600 for Start9/Umbrel</td></tr>
    <tr><td>Time to set up</td><td>4‚Äì16 hours</td><td>Depending on experience level</td></tr>
  </tbody>
</table>
</div>

<h3>Revenue Potential</h3>
<div class="table-wrapper">
<table>
  <thead><tr><th>Monthly Trade Volume</th><th>Fee (0.6%)</th><th>Dev Fee (30%)</th><th>Your Net Revenue</th></tr></thead>
  <tbody>
    <tr><td>$1,000</td><td>~$6</td><td>~$1.80</td><td>~$4.20</td></tr>
    <tr><td>$10,000</td><td>~$60</td><td>~$18</td><td>~$42</td></tr>
    <tr><td>$50,000</td><td>~$300</td><td>~$90</td><td>~$210</td></tr>
    <tr><td>$100,000</td><td>~$600</td><td>~$180</td><td>~$420</td></tr>
  </tbody>
</table>
</div>

<div class="callout note">
  <div class="callout-title">üìù Reality check</div>
  Most new nodes take months to build up trade volume. Don't expect immediate profitability. The real value often comes from providing a service to your community, with fees as a bonus.
</div>

<h3>Time Commitment</h3>
<div class="table-wrapper">
<table>
  <thead><tr><th>Task</th><th>Frequency</th><th>Time</th></tr></thead>
  <tbody>
    <tr><td>Monitoring (check logs, status)</td><td>Daily</td><td>5‚Äì10 min</td></tr>
    <tr><td>Dispute resolution</td><td>As needed</td><td>15‚Äì60 min per dispute</td></tr>
    <tr><td>Updates</td><td>Monthly</td><td>15‚Äì30 min</td></tr>
    <tr><td>Liquidity management</td><td>Weekly</td><td>15‚Äì30 min</td></tr>
    <tr><td><strong>Total weekly estimate</strong></td><td></td><td><strong>1‚Äì3 hours</strong></td></tr>
  </tbody>
</table>
</div>

<hr>

<!-- ============================================================ -->
<h2 id="faq">7. FAQ</h2>

<h3>General Questions</h3>

<details class="collapsible">
<summary>Do I need to be a developer to run a Mostro node?</summary>
<div class="collapsible-content">
<p>No, but you need to be comfortable with basic command-line operations (typing commands, editing text files). The Docker path (Path A) is designed to be accessible. Having someone technical in your community helps a lot though.</p>
</div>
</details>

<details class="collapsible">
<summary>Can I run Mostro on a Raspberry Pi?</summary>
<div class="collapsible-content">
<p>Technically yes (using Start9 or similar), but it's not recommended for production due to limited CPU and RAM. A VPS is more reliable.</p>
</div>
</details>

<details class="collapsible">
<summary>Can I use Core Lightning (CLN) instead of LND?</summary>
<div class="collapsible-content">
<p>No. Mostro currently only supports LND, because it relies on LND's specific hold invoice implementation. Support for other implementations may come in the future.</p>
</div>
</details>

<details class="collapsible">
<summary>How do users connect to my Mostro?</summary>
<div class="collapsible-content">
<p>Users need a Mostro client app (like Mostro Mobile or mostro-cli) and your Mostro's public key (npub). They add your npub to their client, and the client communicates via Nostr relays. No direct connection needed.</p>
</div>
</details>

<details class="collapsible">
<summary>Can I run multiple Mostro instances?</summary>
<div class="collapsible-content">
<p>Yes, but each needs its own Nostr key pair, LND node (or at least separate channels/liquidity), and configuration.</p>
</div>
</details>

<details class="collapsible">
<summary>Is this legal?</summary>
<div class="collapsible-content">
<p>This depends heavily on your jurisdiction. Mostro is software for peer-to-peer trading. In some jurisdictions, operating a P2P exchange may require licenses. <strong>Consult local regulations and legal counsel.</strong> The Mostro project does not provide legal advice.</p>
</div>
</details>

<h3>Technical Questions</h3>

<details class="collapsible">
<summary>How much bandwidth does Mostro use?</summary>
<div class="collapsible-content">
<p>Very little ‚Äî mostly small Nostr events. A few GB per month is typical even with moderate trade volume.</p>
</div>
</details>

<details class="collapsible">
<summary>What happens if my node goes offline?</summary>
<div class="collapsible-content">
<p>Pending orders eventually expire. Active trades with locked funds continue once you come back online (hold invoices have their own expiration). If down too long, users may lose trust and trades could expire unfavorably.</p>
</div>
</details>

<details class="collapsible">
<summary>Can I change my Nostr key later?</summary>
<div class="collapsible-content">
<p>You can, but you'll lose your node's identity and reputation. Users will see it as a brand new Mostro. Treat your key like your brand identity.</p>
</div>
</details>

<details class="collapsible">
<summary>How do I see my node's public key (npub)?</summary>
<div class="collapsible-content">
<p>Derive it from your nsec using any Nostr tool. For example, with <code>mostro-cli</code> or by checking your node's logs at startup (it usually prints the public key).</p>
</div>
</details>

<h3>Financial Questions</h3>

<details class="collapsible">
<summary>Can I lose money running a Mostro node?</summary>
<div class="collapsible-content">
<p>Yes, it's possible: Lightning channel funds could be at risk from bugs (rare); force-closing channels during high-fee periods is expensive; VPS costs are ongoing; time investment is real.</p>
</div>
</details>

<details class="collapsible">
<summary>Is the Lightning liquidity "at risk"?</summary>
<div class="collapsible-content">
<p>Your Lightning liquidity is yours. It's not at risk from Mostro itself ‚Äî hold invoices are temporary locks. However, standard Lightning Network risks apply (force closes, stuck channels, bugs).</p>
</div>
</details>

<details class="collapsible">
<summary>When will I break even?</summary>
<div class="collapsible-content">
<p>Depends on your costs and trade volume. With $20/month costs and 0.6% fee, you need ~$5,000/month in trades to cover costs (before dev fee). Most communities take 3‚Äì6 months to reach meaningful volume.</p>
</div>
</details>

<hr>

<!-- ============================================================ -->
<h2 id="security">8. Security Considerations</h2>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Early-Stage Software Disclaimer</div>
  <p><strong>Mostro is in an early stage of development.</strong> While the team works hard to ensure reliability, there may be undiscovered bugs ‚Äî including security bugs that could result in loss of funds. <strong>The developers are not responsible for any loss of money due to software bugs.</strong></p>
  <p>Mostro is open-source and its code is open to audits. We encourage communities to promote and fund independent security audits.</p>
  <p>That said, <strong>the core escrow mechanism using Lightning hold invoices has been battle-tested since 2021</strong>, when <a href="https://github.com/lnp2pBot/bot" target="_blank" rel="noopener noreferrer">@lnp2pBot</a> first implemented this escrow type. Thousands of trades have been completed using this same logic.</p>
</div>

<h3>Running Under Authoritarian Regimes</h3>

<p>If you operate in a country with an authoritarian government, <strong>privacy is not optional ‚Äî it's a safety requirement.</strong></p>

<ol>
  <li><strong>Run your Mostro node behind Tor and/or a VPN.</strong> This hides your server's IP from Nostr relays.</li>
  <li><strong>If Tor/VPN is not possible</strong> (common in developing countries with slow internet), <strong>only publish events to relays you own or trust.</strong></li>
  <li><strong>Be extremely careful about which relays you use.</strong> In the future, governments may create Nostr relays specifically to collect IP addresses.</li>
  <li><strong>Consider your Lightning node's privacy too.</strong> Running LND behind Tor is possible and recommended in sensitive environments.</li>
</ol>

<div class="callout tip">
  <div class="callout-title">üí° Tip</div>
  The beauty of Mostro being decentralized is that even if one node is shut down, others keep running. But prevention is always better than recovery. Take privacy seriously from day one.
</div>

<hr>

<!-- ============================================================ -->
<h2 id="troubleshooting">9. Troubleshooting</h2>

<h3>Mostro Won't Start</h3>

<h4>"Configuration error: dev_fee_percentage below minimum"</h4>
<p>Set <code>dev_fee_percentage</code> to at least <code>0.10</code> in settings.toml.</p>

<h4>Settings or database file not found</h4>
<p>Make sure the <code>-d</code> flag points to the directory containing <code>settings.toml</code>. For Docker repo build: check <code>docker/config/settings.toml</code> exists. For Docker Hub: check <code>~/mostro-config/settings.toml</code> exists.</p>

<h4>"Failed to connect to LND"</h4>
<ul>
  <li>Verify LND is running: <code>lncli getinfo</code></li>
  <li>Check <code>lnd_grpc_host</code> matches your LND's address</li>
  <li>Verify <code>tls.cert</code> and <code>admin.macaroon</code> paths are correct</li>
  <li>Docker + LND on host: use <code>host.docker.internal</code></li>
</ul>

<h3>Connection Issues</h3>

<h4>Mostro starts but doesn't connect to relays</h4>
<ul>
  <li>Check relay URLs (should start with <code>wss://</code>)</li>
  <li>Ensure your VPS firewall allows outbound on port 443</li>
  <li>Try different relays ‚Äî some may be temporarily down</li>
</ul>

<h3>Trade Issues</h3>

<h4>Orders aren't showing up on clients</h4>
<ul>
  <li>Verify relay connections in logs</li>
  <li>Make sure clients use the same relays as your node</li>
  <li>Check info event is publishing:</li>
</ul>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>nostreq --kinds 38383 --limit 1 --authors YOUR_HEX_PUBKEY | nostcat --stream wss://nos.lol</code></pre>
</div>

<h4>Payments failing</h4>
<ul>
  <li>Check liquidity: <code>lncli listchannels</code></li>
  <li>Ensure enough outbound capacity</li>
  <li>Check <code>max_routing_fee</code> ‚Äî if too low, payments may fail to route</li>
</ul>

<h3>Database Issues</h3>

<h4>Database locked errors</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>ps aux | grep mostrod
<span class="cm"># If multiple processes, kill extras:</span>
kill &lt;PID&gt;</code></pre>
</div>

<h3>Docker-Specific Issues</h3>

<h4>"Cannot connect to Docker daemon"</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>systemctl start docker</code></pre>
</div>

<h4>Build fails with out-of-memory</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>fallocate -l 2G /swapfile && chmod 600 /swapfile && mkswap /swapfile && swapon /swapfile</code></pre>
</div>

<h3>Getting Help</h3>

<ol>
  <li><strong>Check the logs first</strong> ‚Äî most errors explain what went wrong</li>
  <li><strong>Telegram (Developers):</strong> <a href="https://t.me/mostro_dev" target="_blank" rel="noopener noreferrer">@mostro_dev</a></li>
  <li><strong>Telegram (Community):</strong> <a href="https://t.me/MostroP2P" target="_blank" rel="noopener noreferrer">@MostroP2P</a></li>
  <li><strong>GitHub Issues:</strong> <a href="https://github.com/MostroP2P/mostro/issues" target="_blank" rel="noopener noreferrer">github.com/MostroP2P/mostro/issues</a></li>
  <li><strong>DeepWiki:</strong> <a href="https://deepwiki.com/MostroP2P/mostro" target="_blank" rel="noopener noreferrer">deepwiki.com/MostroP2P/mostro</a></li>
</ol>

<p>When asking for help, always include: your Mostro version, the relevant log output, and what you've already tried.</p>

<hr>

<!-- ============================================================ -->
<h2 id="appendix">Appendix: Quick Reference</h2>

<h3>Important File Locations</h3>
<div class="table-wrapper">
<table>
  <thead><tr><th>File</th><th>Docker (repo build)</th><th>Docker Hub</th><th>Native</th></tr></thead>
  <tbody>
    <tr><td>Configuration</td><td><code>/opt/mostro/docker/config/settings.toml</code></td><td><code>~/mostro-config/settings.toml</code></td><td><code>/opt/mostro/settings.toml</code></td></tr>
    <tr><td>Database</td><td><code>/opt/mostro/docker/config/mostro.db</code></td><td><code>~/mostro-config/mostro.db</code></td><td><code>/opt/mostro/mostro.db</code></td></tr>
    <tr><td>LND cert</td><td><code>/opt/mostro/docker/config/lnd/tls.cert</code></td><td><code>~/mostro-config/lnd/tls.cert</code></td><td>Varies (check LND config)</td></tr>
    <tr><td>LND macaroon</td><td><code>/opt/mostro/docker/config/lnd/admin.macaroon</code></td><td><code>~/mostro-config/lnd/admin.macaroon</code></td><td>Varies (check LND config)</td></tr>
    <tr><td>Service file</td><td>N/A</td><td>N/A</td><td><code>/etc/systemd/system/mostro.service</code></td></tr>
    <tr><td>Logs</td><td><code>docker compose logs</code></td><td><code>docker logs -f mostro</code></td><td><code>journalctl -u mostro</code></td></tr>
  </tbody>
</table>
</div>

<h3>Essential Commands</h3>
<div class="code-block">
  <div class="code-block-header"><span>bash ‚Äî Docker</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>make docker-build          <span class="cm"># Build/rebuild</span>
make docker-up             <span class="cm"># Start</span>
make docker-down           <span class="cm"># Stop</span>
docker compose logs -f     <span class="cm"># View logs</span></code></pre>
</div>

<div class="code-block">
  <div class="code-block-header"><span>bash ‚Äî Native</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>systemctl start mostro     <span class="cm"># Start</span>
systemctl stop mostro      <span class="cm"># Stop</span>
systemctl restart mostro   <span class="cm"># Restart</span>
systemctl status mostro    <span class="cm"># Check status</span>
journalctl -u mostro -f    <span class="cm"># View logs</span></code></pre>
</div>

<div class="code-block">
  <div class="code-block-header"><span>bash ‚Äî Database</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>sqlite3 mostro.db "SELECT COUNT(*) FROM orders;"                           <span class="cm"># Total orders</span>
sqlite3 mostro.db "SELECT COUNT(*) FROM orders WHERE status='success';"    <span class="cm"># Successful trades</span>
sqlite3 mostro.db "SELECT SUM(fee*2) FROM orders WHERE status='success';"  <span class="cm"># Total fees earned</span></code></pre>
</div>

<h3>Recommended Settings for New Nodes</h3>
<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copy" data-copied="Copied!">Copy</button></div>
  <pre><code>[mostro]
fee = 0.006
max_order_amount = 500000
min_payment_amount = 1000
expiration_hours = 24
expiration_seconds = 900
pow = 0
dev_fee_percentage = 0.30
fiat_currencies_accepted = ['USD']  <span class="cm"># Change to your local currency</span>

[nostr]
relays = [
  'wss://relay.mostro.network',
  'wss://nos.lol',
  'wss://relay.nostr.band'
]</code></pre>
</div>

<!-- Footer -->
<div class="guide-footer">
  <p>This guide is maintained by the Mostro community. Found an error or want to improve it?<br>
  Contributions welcome at <a href="https://github.com/MostroP2P/mostro" target="_blank" rel="noopener noreferrer">github.com/MostroP2P/mostro</a></p>
  <p style="margin-top:12px;">Last updated: February 2026 ¬∑ Mostro v0.16.2</p>
</div>

</main>

<!-- Back to top button -->
<button class="back-to-top" id="backToTop" onclick="window.scrollTo({top:0,behavior:'smooth'})">‚Üë</button>

<script src="guide.js"></script>

</body>
</html>
