<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gu√≠a de Configuraci√≥n de Nodo | Mostro P2P</title>
  <meta name="description" content="Gu√≠a completa para ejecutar tu propio nodo Mostro P2P de intercambio de Bitcoin. Configuraci√≥n paso a paso para Docker y compilaci√≥n nativa.">
  <link rel="stylesheet" href="guide-styles.css">
  <link rel="icon" href="../assets/images/favicon.png" type="image/png">
</head>
<body>

<!-- Header -->
<header class="guide-header">
  <a href="../index.es.html" class="header-logo">
    <img src="../assets/images/logo.svg" alt="Mostro">
    <span>Gu√≠a del Nodo</span>
  </a>
  <div class="header-right">
    <div class="lang-switcher">
      <a href="index.html">EN</a>
      <a href="index.es.html" class="active">ES</a>
      <a href="index.it.html">IT</a>
      <a href="index.pt.html">PT</a>
    </div>
    <button class="toc-toggle" onclick="toggleSidebar()">‚ò∞ Men√∫</button>
  </div>
</header>

<div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

<aside class="guide-sidebar" id="sidebar">
  <div class="toc-title">Tabla de Contenidos</div>
  <ul class="toc-list">
    <li><a href="#que-es-mostro">1. ¬øQu√© es Mostro?</a></li>
    <li class="toc-sub"><a href="#por-que-nodo">¬øPor qu√© un nodo?</a></li>
    <li class="toc-sub"><a href="#como-funciona">C√≥mo funciona</a></li>
    <li><a href="#prerequisitos">2. Prerequisitos</a></li>
    <li class="toc-sub"><a href="#vps">Servidor (VPS)</a></li>
    <li class="toc-sub"><a href="#lnd">Nodo Lightning (LND)</a></li>
    <li class="toc-sub"><a href="#liquidez">Liquidez</a></li>
    <li class="toc-sub"><a href="#claves-nostr">Claves Nostr</a></li>
    <li class="toc-sub"><a href="#nivel-tecnico">Nivel t√©cnico</a></li>
    <li><a href="#instalacion">3. Instalaci√≥n paso a paso</a></li>
    <li class="toc-sub"><a href="#opcion-a-dockerhub">Opci√≥n A: Docker Hub</a></li>
    <li class="toc-sub"><a href="#opcion-b-docker-build">Opci√≥n B: Docker Build</a></li>
    <li class="toc-sub"><a href="#opcion-c-nativo">Opci√≥n C: Compilar</a></li>
    <li><a href="#configuracion">4. Configuraci√≥n</a></li>
    <li class="toc-sub"><a href="#cfg-nostr">Claves Nostr</a></li>
    <li class="toc-sub"><a href="#cfg-comisiones">Comisiones</a></li>
    <li class="toc-sub"><a href="#cfg-limites">L√≠mites</a></li>
    <li class="toc-sub"><a href="#cfg-perfil">Perfil del nodo</a></li>
    <li class="toc-sub"><a href="#cfg-tiempos">Tiempos</a></li>
    <li class="toc-sub"><a href="#cfg-antispam">Anti-Spam</a></li>
    <li class="toc-sub"><a href="#cfg-rpc">RPC Admin</a></li>
    <li><a href="#operacion">5. Operaci√≥n del nodo</a></li>
    <li class="toc-sub"><a href="#disputas">Disputas</a></li>
    <li class="toc-sub"><a href="#mostrix">Mostrix</a></li>
    <li class="toc-sub"><a href="#watchdog">mostro-watchdog</a></li>
    <li class="toc-sub"><a href="#monitoreo">Monitoreo</a></li>
    <li class="toc-sub"><a href="#actualizacion">Actualizaci√≥n</a></li>
    <li class="toc-sub"><a href="#respaldos">Respaldos</a></li>
    <li class="toc-sub"><a href="#actividad">Actividad</a></li>
    <li><a href="#costos">6. Desglose de costos</a></li>
    <li><a href="#preguntas">7. Preguntas frecuentes</a></li>
    <li><a href="#seguridad">8. Seguridad</a></li>
    <li><a href="#solucion-problemas">9. Soluci√≥n de problemas</a></li>
    <li><a href="#apendice">Ap√©ndice</a></li>
  </ul>
</aside>

<main class="guide-content">

<h1>Ejecutando Tu Propio Nodo Mostro</h1>
<p class="guide-version">Mostro v0.16.3 ‚Äî Gu√≠a de la Comunidad ¬∑ Febrero 2026</p>

<!-- ============================================================ -->
<h2 id="que-es-mostro">1. ¬øQu√© es Mostro y por qu√© tu comunidad deber√≠a ejecutar uno?</h2>

<h3 id="que-es-mostro-sub">¬øQu√© es Mostro?</h3>

<p>Mostro es un <strong>exchange peer-to-peer de Bitcoin</strong> que permite a las personas comprar y vender Bitcoin usando monedas locales (d√≥lares, euros, pesos ‚Äî cualquier moneda) sin necesidad de proporcionar documentos de identidad (KYC). Piensa en √©l como un mercado descentralizado donde compradores y vendedores pueden comerciar directamente.</p>

<p>Funciona usando dos tecnolog√≠as:</p>
<ul>
  <li><strong>Lightning Network</strong> ‚Äî una capa de pagos r√°pidos y de bajo costo para Bitcoin (piensa en ella como la v√≠a r√°pida de Bitcoin para pagos peque√±os y √°giles)</li>
  <li><strong>Nostr</strong> ‚Äî un protocolo de comunicaci√≥n resistente a la censura (piensa en √©l como un sistema de mensajer√≠a que nadie puede apagar)</li>
</ul>

<p>Mostro act√∫a como un <strong>coordinador de custodia</strong> ‚Äî retiene los Bitcoin del vendedor en una "caja fuerte" temporal (llamada hold invoice) hasta que el comprador confirma que ha enviado el pago en moneda local. Mostro nunca controla realmente los fondos de nadie; solo los retiene brevemente durante la operaci√≥n.</p>

<h3 id="por-que-nodo">¬øPor qu√© tu comunidad querr√≠a ejecutar un nodo Mostro?</h3>

<ol>
  <li><strong>Ingresos por comisiones</strong> ‚Äî Cada operaci√≥n te genera una comisi√≥n (0.6% por defecto). Si tu comunidad hace $10,000 en operaciones mensuales, son ~$60/mes en comisiones.</li>
  <li><strong>Trading P2P sin KYC</strong> ‚Äî Los miembros de tu comunidad pueden comprar y vender Bitcoin sin proporcionar documentos de identidad. Especialmente importante en regiones con monedas inestables o regulaciones restrictivas.</li>
  <li><strong>Disputas en tu idioma</strong> ‚Äî Cuando una operaci√≥n sale mal, <em>tu</em> comunidad la resuelve, en <em>tu</em> idioma, entendiendo <em>tus</em> m√©todos de pago locales.</li>
  <li><strong>Independencia</strong> ‚Äî Ninguna empresa puede cerrar tu exchange. Ning√∫n gobierno puede presionar a un √∫nico operador para cerrarlo.</li>
  <li><strong>Personalizaci√≥n</strong> ‚Äî T√∫ eliges qu√© monedas soportar, qu√© m√©todos de pago permitir y qu√© comisiones cobrar.</li>
</ol>

<h3 id="como-funciona">C√≥mo funciona Mostro (Simplificado)</h3>

<div class="flow-diagram"><span class="step-num">1.</span> Alice quiere VENDER Bitcoin por $50 USD
   <span class="arrow">‚Üí</span> Crea una orden en Mostro

<span class="step-num">2.</span> Bob quiere COMPRAR Bitcoin con $50 USD
   <span class="arrow">‚Üí</span> Ve la orden de Alice y la toma

<span class="step-num">3.</span> Mostro crea una "caja fuerte" (hold invoice)
   <span class="arrow">‚Üí</span> Alice env√≠a sus Bitcoin a la caja fuerte

<span class="step-num">4.</span> Bob env√≠a $50 a Alice por transferencia bancaria, Zelle, efectivo, etc.
   <span class="arrow">‚Üí</span> Bob presiona "Fiat Enviado" en su app

<span class="step-num">5.</span> Alice confirma que recibi√≥ los $50
   <span class="arrow">‚Üí</span> Presiona "Liberar"

<span class="step-num">6.</span> Mostro libera los Bitcoin de la caja fuerte a Bob
   <span class="arrow">‚Üí</span> ¬°Operaci√≥n completada! <span class="check">‚úì</span></div>

<p>Si algo sale mal (ej: Bob dice que pag√≥ pero Alice no lo recibi√≥), cualquiera de las partes puede abrir una <strong>disputa</strong>, y los √°rbitros asignados de tu comunidad investigan y resuelven.</p>

<hr>

<!-- ============================================================ -->
<h2 id="prerequisitos">2. Prerequisitos ‚Äî Lo que necesitas antes de empezar</h2>

<h3 id="vps">2.1 Un Servidor (VPS)</h3>

<p>Un <strong>VPS</strong> (Servidor Virtual Privado) es una computadora en un centro de datos que funciona 24/7. Alquilar√°s uno para alojar tu nodo Mostro.</p>

<p><strong>Especificaciones m√≠nimas:</strong></p>
<div class="table-wrapper">
<table>
  <thead><tr><th>Recurso</th><th>M√≠nimo</th><th>Recomendado</th></tr></thead>
  <tbody>
    <tr><td>CPU</td><td>2 vCPUs (compartidos)</td><td>2+ vCPUs</td></tr>
    <tr><td>RAM</td><td>2 GB</td><td>4 GB</td></tr>
    <tr><td>Almacenamiento</td><td>60 GB SSD</td><td>100 GB SSD</td></tr>
    <tr><td>Ancho de banda</td><td>3 TB/mes</td><td>3+ TB/mes</td></tr>
    <tr><td>SO</td><td>Ubuntu 22.04+ LTS</td><td>Ubuntu 24.04 LTS</td></tr>
  </tbody>
</table>
</div>

<p><strong>Costo mensual estimado:</strong> $10‚Äì$24/mes.</p>

<p><strong>Proveedores populares de VPS:</strong></p>
<ul>
  <li><a href="https://www.hostinger.com/" target="_blank" rel="noopener noreferrer">Hostinger</a> ‚Äî desde ~$7/mes (precio promocional; la renovaci√≥n puede ser mayor) (KVM 2: 2 vCPU, 8GB RAM, 100GB NVMe, 8TB bandwidth) ¬∑ Acepta Bitcoin</li>
  <li><a href="https://www.hetzner.com/" target="_blank" rel="noopener noreferrer">Hetzner</a> ‚Äî ‚Ç¨3.49-8/mes (CX23 desde ‚Ç¨3.49, buena relaci√≥n calidad-precio, con base en la UE)</li>
  <li><a href="https://www.digitalocean.com/" target="_blank" rel="noopener noreferrer">Digital Ocean</a> ‚Äî $24/mes (4GB RAM, 2 CPUs, 80GB SSD) o $32/mes (4GB RAM, 2 Intel CPUs, 120GB NVMe)</li>
  <li><a href="https://www.ovhcloud.com/" target="_blank" rel="noopener noreferrer">OVH</a> ‚Äî ~$6-12/mes</li>
  <li><a href="https://www.linode.com/" target="_blank" rel="noopener noreferrer">Linode/Akamai</a> ‚Äî $12/mes</li>
  <li><a href="https://www.lunanode.com/" target="_blank" rel="noopener noreferrer">Lunanode</a> ‚Äî Acepta pagos en Bitcoin</li>
</ul>

<div class="callout tip">
  <div class="callout-title">üí° Consejo</div>
  Muchos proveedores de VPS aceptan pagos en Bitcoin. Busca esa opci√≥n si quieres mantener coherencia con la filosof√≠a de Bitcoin.
</div>

<p>Necesitas sentirte c√≥modo conect√°ndote a un servidor por SSH. Si nunca lo has hecho, busca un tutorial sobre "Conectarse por SSH a un VPS" ‚Äî es m√°s simple de lo que parece.</p>

<h3 id="lnd">2.2 Un Nodo Lightning Network (LND)</h3>

<p>Lightning Network es un sistema "capa 2" construido sobre Bitcoin que permite pagos r√°pidos y baratos. Para ejecutar Mostro, necesitas un <strong>nodo LND</strong> (Lightning Network Daemon) ‚Äî el software Lightning espec√≠fico con el que Mostro trabaja.</p>

<p><strong>Tus opciones:</strong></p>
<div class="table-wrapper">
<table>
  <thead><tr><th>Opci√≥n</th><th>Dificultad</th><th>Costo</th><th>Notas</th></tr></thead>
  <tbody>
    <tr><td>Usar un nodo LND existente</td><td><span class="badge badge-easy">F√°cil</span></td><td>Gratis (si tienes uno)</td><td>Mejor si alguien ya tiene uno</td></tr>
    <tr><td>Ejecutar LND en el mismo VPS</td><td><span class="badge badge-hard">Dif√≠cil</span></td><td>Mismo VPS + liquidez</td><td>Requiere VPS con 4GB+ RAM</td></tr>
    <tr><td>Soluci√≥n nodo-en-caja</td><td><span class="badge badge-medium">Medio</span></td><td>$200-600 + liquidez</td><td><a href="https://start9.com/" target="_blank" rel="noopener noreferrer">Start9</a>, <a href="https://umbrel.com/" target="_blank" rel="noopener noreferrer">Umbrel</a>, <a href="https://raspiblitz.org/" target="_blank" rel="noopener noreferrer">RaspiBlitz</a></td></tr>
    <tr><td>StartOS con paquete Mostro</td><td><span class="badge badge-easy">M√°s f√°cil</span></td><td>$300-600 + liquidez</td><td>Start9 tiene un paquete Mostro de un clic</td></tr>
    <tr><td>Usar Voltage.cloud</td><td><span class="badge badge-easy">F√°cil</span></td><td>Desde ~$20/mes + liquidez</td><td><a href="https://voltage.cloud/" target="_blank" rel="noopener noreferrer">Voltage</a> ‚Äî LND alojado con infraestructura administrada</td></tr>
  </tbody>
</table>
</div>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Importante</div>
  Mostro requiere espec√≠ficamente <strong>LND</strong> (no CLN/Core Lightning, no Eclair, no LDK). Aseg√∫rate de que tu nodo Lightning ejecute LND.
</div>

<p><strong>Lo que necesitas de tu nodo LND:</strong></p>
<ul>
  <li>El archivo <code>tls.cert</code> (un certificado de seguridad)</li>
  <li>El archivo <code>admin.macaroon</code> (un token de autenticaci√≥n)</li>
  <li>La direcci√≥n gRPC (t√≠picamente <code>https://127.0.0.1:10009</code> si est√° en la misma m√°quina)</li>
</ul>

<h3 id="liquidez">2.3 Liquidez Lightning</h3>

<p>Para facilitar operaciones, tu nodo Lightning necesita <strong>canales</strong> con Bitcoin en ellos. Piensa en los canales Lightning como t√∫neles de pago pre-financiados. El Bitcoin dentro de estos canales es tu "liquidez".</p>

<p><strong>¬øCu√°nta necesitas?</strong></p>
<div class="table-wrapper">
<table>
  <thead><tr><th>Volumen de trading objetivo</th><th>Liquidez sugerida</th><th>BTC aproximado</th></tr></thead>
  <tbody>
    <tr><td>Comunidad peque√±a (pocas operaciones/d√≠a)</td><td>1‚Äì5 millones de sats</td><td>0.01‚Äì0.05 BTC</td></tr>
    <tr><td>Comunidad mediana</td><td>5‚Äì20 millones de sats</td><td>0.05‚Äì0.20 BTC</td></tr>
    <tr><td>Comunidad activa</td><td>20‚Äì100 millones de sats</td><td>0.20‚Äì1.0 BTC</td></tr>
  </tbody>
</table>
</div>

<div class="callout tip">
  <div class="callout-title">üí° Nota sobre Liquidez Lightning</div>
  El Bitcoin en tus canales Lightning est√° bloqueado <strong>onchain</strong> pero sigue siendo altamente gastable v√≠a Lightning Network. Muchos servicios aceptan pagos Lightning ‚Äî desde cafeter√≠as hasta proveedores VPS ‚Äî haciendo tu liquidez bastante flexible para uso cotidiano.
</div>

<p><strong>Empieza peque√±o, crece incrementalmente.</strong> Comienza con lo suficiente para las necesidades iniciales de tu comunidad y monitorea el feedback. Cuando los traders reporten que las √≥rdenes fallan por capacidad insuficiente, esa es tu se√±al para agregar m√°s. Escucha a tu comunidad.</p>

<p><strong>Obteniendo liquidez:</strong></p>
<ul>
  <li>Abre canales a nodos bien conectados (usa <a href="https://1ml.com/" target="_blank" rel="noopener noreferrer">1ML</a> o <a href="https://amboss.space/" target="_blank" rel="noopener noreferrer">Amboss</a> para encontrar buenos pares)</li>
  <li>Necesitas capacidad <strong>saliente</strong> (para pagar a compradores) y capacidad <strong>entrante</strong> (para recibir de vendedores)</li>
  <li>Obtener liquidez entrante suele ser m√°s dif√≠cil ‚Äî considera <a href="https://lightning.engineering/loop/" target="_blank" rel="noopener noreferrer">Lightning Loop</a>, <a href="https://amboss.space/magma" target="_blank" rel="noopener noreferrer">Magma</a>, o servicios de intercambio de canales</li>
</ul>

<h3 id="claves-nostr">2.4 Claves Nostr</h3>

<p>Tu nodo Mostro necesita su propia identidad en la red Nostr ‚Äî un par de claves criptogr√°ficas con una clave p√∫blica (la direcci√≥n de tu nodo) y una clave privada (tu secreto).</p>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Importante</div>
  Nunca reutilices claves Nostr entre instancias de Mostro. Cada nodo necesita su propia identidad √∫nica.
</div>

<p><strong>Generando claves Nostr seguras localmente con rana:</strong></p>

<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Instalar Rust (si no est√° instalado)</span>
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
source ~/.cargo/env

<span class="cm"># Instalar rana - generador local de claves Nostr</span>
cargo install rana

<span class="cm"># Generar un nuevo par de claves</span>
rana</code></pre>
</div>

<p>Rana generar√° tanto tu clave privada (nsec) como tu clave p√∫blica (npub). <strong>¬°Guarda ambas de forma segura!</strong> Nunca generes claves importantes como estas usando servicios online ‚Äî siempre usa herramientas locales como rana por seguridad.</p>

<h3 id="nivel-tecnico">2.5 Nivel de conocimiento t√©cnico</h3>

<div class="table-wrapper">
<table>
  <thead><tr><th>Tarea</th><th>Dificultad</th><th>Conocimientos necesarios</th></tr></thead>
  <tbody>
    <tr><td>Alquilar un VPS</td><td><span class="badge badge-easy">F√°cil</span></td><td>Tarjeta de cr√©dito, navegaci√≥n web b√°sica</td></tr>
    <tr><td>Conectarse por SSH</td><td><span class="badge badge-easy">F√°cil</span></td><td>Seguir instrucciones, escribir comandos</td></tr>
    <tr><td>Instalar Docker</td><td><span class="badge badge-medium">Medio</span></td><td>Copiar y pegar comandos, soluci√≥n b√°sica de problemas</td></tr>
    <tr><td>Ejecutar Mostro (Docker)</td><td><span class="badge badge-medium">Medio</span></td><td>Editar archivos de configuraci√≥n, entender rutas</td></tr>
    <tr><td>Ejecutar Mostro (nativo)</td><td><span class="badge badge-hard">Dif√≠cil</span></td><td>Administraci√≥n Linux, compilaci√≥n de software, systemd</td></tr>
    <tr><td>Configurar LND desde cero</td><td><span class="badge badge-hard">Dif√≠cil</span></td><td>Conocimiento significativo de Linux y redes</td></tr>
    <tr><td>Gestionar liquidez Lightning</td><td><span class="badge badge-hard">Dif√≠cil</span></td><td>Entender la econom√≠a de canales Lightning</td></tr>
  </tbody>
</table>
</div>

<p><strong>Nuestra recomendaci√≥n:</strong> Si tu comunidad tiene a alguien c√≥modo con la l√≠nea de comandos de Linux, puede manejar la instalaci√≥n Docker (Opci√≥n A o B). Para la Opci√≥n C, necesitas a alguien con experiencia en administraci√≥n de sistemas. La configuraci√≥n del nodo Lightning es la parte m√°s compleja ‚Äî considera pedir ayuda a alguien experimentado, o usar una soluci√≥n nodo-en-caja.</p>

<hr>

<!-- ============================================================ -->
<h2 id="instalacion">3. Instalaci√≥n Paso a Paso</h2>

<p>Todas las opciones de instalaci√≥n comparten los mismos primeros pasos. Luego elige la opci√≥n que prefieras:</p>
<ul>
  <li><strong>Opci√≥n A (Docker Hub):</strong> La m√°s r√°pida. Sin compilar, sin clonar. Recomendada para la mayor√≠a.</li>
  <li><strong>Opci√≥n B (Docker Build):</strong> Construyes la imagen localmente desde el repositorio.</li>
  <li><strong>Opci√≥n C (Compilaci√≥n nativa):</strong> M√°s control, mejor para sysadmins experimentados.</li>
</ul>

<p>Todas asumen que ya tienes: ‚úÖ Un VPS con Ubuntu ¬∑ ‚úÖ Acceso SSH ¬∑ ‚úÖ Un nodo LND funcionando.</p>

<h3>Pasos Comunes (para las 3 opciones)</h3>

<h4>Paso 1: Con√©ctate a tu VPS</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>ssh root@TU_DIRECCION_IP_DEL_VPS</code></pre>
</div>

<h4>Paso 2: Actualiza el sistema</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Descargar la informaci√≥n m√°s reciente de paquetes</span>
apt update

<span class="cm"># Instalar todas las actualizaciones disponibles</span>
apt upgrade -y</code></pre>
</div>

<h4>Paso 3: Instalar Docker y Docker Compose</h4>

<div class="callout tip">
  <div class="callout-title">üí° Nota</div>
  Docker es necesario para las opciones A y B. Si vas a compilar manualmente (Opci√≥n C), puedes saltar este paso.
</div>

<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Instalar Docker con el script oficial</span>
curl -fsSL https://get.docker.com | sh

<span class="cm"># Verificar que Docker est√° instalado</span>
docker --version
<span class="cm"># Esperado: Docker version 24.x.x o m√°s reciente</span>

<span class="cm"># Verificar Docker Compose</span>
docker compose version
<span class="cm"># Esperado: Docker Compose version v2.x.x</span></code></pre>
</div>

<h4>Paso 4: Instalar herramientas adicionales</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>apt install -y git make</code></pre>
</div>

<p>‚úÖ <strong>Pasos comunes completados.</strong> Ahora elige tu opci√≥n de instalaci√≥n:</p>

<hr>

<!-- Option A: Docker Hub -->
<details class="collapsible" id="opcion-a-dockerhub" open>
<summary>Opci√≥n A: Docker Hub (La m√°s r√°pida ‚Äî Recomendada)</summary>
<div class="collapsible-content">

<p>Ejecuta Mostro directamente desde Docker Hub sin clonar el repositorio ni compilar. Perfecto para deployments en VPS.</p>

<h4>Paso 5: Crear directorio de configuraci√≥n</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>mkdir -p ~/mostro-config/lnd</code></pre>
</div>

<h4>Paso 6: Obtener el template de configuraci√≥n</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>curl -sL https://raw.githubusercontent.com/MostroP2P/mostro/v0.16.3/settings.tpl.toml -o ~/mostro-config/settings.toml</code></pre>
</div>

<h4>Paso 7: Copiar credenciales LND</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>cp /ruta/a/tu/tls.cert ~/mostro-config/lnd/tls.cert
cp /ruta/a/tu/admin.macaroon ~/mostro-config/lnd/admin.macaroon</code></pre>
</div>

<p>Si LND est√° en la <strong>misma m√°quina</strong>, las rutas t√≠picas son:</p>
<ul>
  <li><code>/root/.lnd/tls.cert</code></li>
  <li><code>/root/.lnd/data/chain/bitcoin/mainnet/admin.macaroon</code></li>
</ul>

<h4>Paso 8: Editar la configuraci√≥n</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>nano ~/mostro-config/settings.toml</code></pre>
</div>

<p><strong>Cambios requeridos:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>[lightning]
lnd_cert_file = '/config/lnd/tls.cert'
lnd_macaroon_file = '/config/lnd/admin.macaroon'
lnd_grpc_host = 'https://host.docker.internal:10009'  <span class="cm"># Si LND en el mismo VPS</span>
<span class="cm"># O usar 'https://TU_IP_LND:10009' si LND en servidor diferente</span>

[database]
url = "sqlite:///config/mostro.db"

[nostr]
nsec_privkey = 'TU_CLAVE_NSEC_AQUI'
relays = ['wss://relay.mostro.network', 'wss://nos.lol']

[mostro]
fee = 0.006                    <span class="cm"># 0.6% comisi√≥n por operaci√≥n</span>
max_order_amount = 1000000     <span class="cm"># Orden m√°xima en sats</span>
min_payment_amount = 100       <span class="cm"># Orden m√≠nima en sats</span>
fiat_currencies_accepted = ['USD', 'EUR']  <span class="cm"># Tus monedas</span></code></pre>
</div>

<p>Guardar: <code>Ctrl+X</code>, luego <code>Y</code>, luego <code>Enter</code>.</p>

<h4>Paso 9: Ajustar permisos</h4>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Importante</div>
  Evita <code>chmod 777</code>. Usa permisos m√≠nimos: asigna el directorio al UID:GID del runtime del contenedor y protege los archivos sensibles.
</div>

<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Descubrir UID/GID del runtime del contenedor</span>
docker run --rm --entrypoint id mostrop2p/mostro:v0.16.3 -u
docker run --rm --entrypoint id mostrop2p/mostro:v0.16.3 -g

<span class="cm"># Reemplaza 1000:1000 por el UID:GID detectado</span>
sudo chown -R 1000:1000 ~/mostro-config
sudo chmod 700 ~/mostro-config
sudo chmod 600 ~/mostro-config/settings.toml
sudo chmod 640 ~/mostro-config/lnd/admin.macaroon</code></pre>
</div>

<h4>Paso 10: Ejecutar el contenedor</h4>

<p><strong>Si LND est√° en el mismo VPS:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>docker run -d --name mostro \
  --restart unless-stopped \
  --add-host=host.docker.internal:host-gateway \
  -v ~/mostro-config:/config \
  mostrop2p/mostro:v0.16.3</code></pre>
</div>

<p><strong>Si LND est√° en un servidor diferente:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>docker run -d --name mostro \
  --restart unless-stopped \
  -v ~/mostro-config:/config \
  mostrop2p/mostro:v0.16.3</code></pre>
</div>

<h4>Paso 11: Revisar los logs</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>docker logs -f mostro</code></pre>
</div>

<p>Busca estos mensajes:</p>
<ul>
  <li><code>Settings correctly loaded</code> ‚Äî La configuraci√≥n es v√°lida</li>
  <li><code>Connected to LND</code> ‚Äî Conexi√≥n Lightning exitosa</li>
  <li><code>Connected to relay</code> ‚Äî Relay Nostr establecido</li>
</ul>

<div class="callout tip">
  <div class="callout-title">üí° Soluci√≥n de problemas</div>
  Si ves <code>Permission denied (os error 13)</code>, vuelve a detectar UID:GID del contenedor y ajusta permisos con <code>chown -R UID:GID ~/mostro-config</code>, <code>chmod 700 ~/mostro-config</code>, <code>chmod 600 ~/mostro-config/settings.toml</code> y <code>chmod 640 ~/mostro-config/lnd/admin.macaroon</code>; luego reinicia: <code>docker restart mostro</code>.
</div>

<p><strong>Ventajas de Docker Hub:</strong></p>
<ul>
  <li>‚úÖ Sin tiempo de compilaci√≥n</li>
  <li>‚úÖ No necesita clonar repositorio</li>
  <li>‚úÖ Menores requerimientos de almacenamiento</li>
  <li>‚úÖ Actualizaciones controladas con tags versionados (ej. <code>mostrop2p/mostro:v0.16.3</code>)</li>
</ul>

<div class="callout warning">
  <div class="callout-title">üîí Nota de Seguridad</div>
  Recomendado: usa siempre un tag de versi√≥n espec√≠fica (ej. <code>mostrop2p/mostro:v0.16.3</code>) para controlar despliegues y probar cambios antes de actualizar producci√≥n.
</div>

<p>üéâ <strong>¬°Felicitaciones!</strong> Si ves conexiones exitosas en los logs, ¬°tu nodo Mostro est√° funcionando!</p>

</div>
</details>

<hr>

<!-- Option B: Docker Build -->
<details class="collapsible" id="opcion-b-docker-build">
<summary>Opci√≥n B: Docker Build (Construir imagen localmente)</summary>
<div class="collapsible-content">

<h4>Paso 5: Descargar Mostro</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>cd /opt
git clone https://github.com/MostroP2P/mostro.git
cd mostro</code></pre>
</div>

<h4>Paso 6: Configurar archivos</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>cd docker
mkdir -p config
cp ../settings.tpl.toml config/settings.toml</code></pre>
</div>

<div class="callout tip">
  <div class="callout-title">üí° Cambios en v0.16.3+</div>
  <ul>
    <li>Ya no hay <code>empty.mostro.db</code> ‚Äî Mostro crea la base de datos autom√°ticamente</li>
    <li><code>settings.docker.toml</code> ‚Üí <code>settings.tpl.toml</code> (cambi√≥ el nombre del template)</li>
    <li>Archivo <code>docker/.env</code> opcional ‚Äî para configuraci√≥n de contrase√±a de BD sin interacci√≥n</li>
  </ul>
</div>

<h4>Paso 7: Editar el archivo de configuraci√≥n</h4>

<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>nano config/settings.toml</code></pre>
</div>

<p><strong>Debes</strong> cambiar estas configuraciones clave:</p>
<ol>
  <li><strong><code>lnd_grpc_host</code></strong> ‚Äî La direcci√≥n de tu nodo LND:
    <ul>
      <li>Misma m√°quina: <code>'https://host.docker.internal:10009'</code></li>
      <li>M√°quina diferente: <code>'https://TU_IP_LND:10009'</code></li>
    </ul>
  </li>
  <li><strong><code>lnd_cert_file</code></strong> y <strong><code>lnd_macaroon_file</code></strong> ‚Äî Config√∫ralos como:
    <ul>
      <li><code>lnd_cert_file = '/config/lnd/tls.cert'</code></li>
      <li><code>lnd_macaroon_file = '/config/lnd/admin.macaroon'</code></li>
    </ul>
  </li>
  <li><strong><code>nsec_privkey</code></strong> ‚Äî La clave privada Nostr de tu Mostro. Genera localmente usando <code>rana</code> (ver secci√≥n 2.4). <strong>¬°Guarda tanto la nsec como la npub de forma segura!</strong></li>
  <li><strong><code>relays</code></strong> ‚Äî Los relays Nostr a los que tu nodo se conectar√°.</li>
  <li><strong><code>url</code></strong> (en la secci√≥n [database]) ‚Äî Config√∫ralo como: <code>"sqlite:///config/mostro.db"</code></li>
</ol>

<p><strong>Otros ajustes que probablemente querr√°s cambiar:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>[mostro]
fee = 0.006                    <span class="cm"># 0.6% comisi√≥n por operaci√≥n</span>
max_order_amount = 1000000     <span class="cm"># Orden m√°xima en sats (~$400-500)</span>
min_payment_amount = 100       <span class="cm"># Orden m√≠nima en sats</span>
fiat_currencies_accepted = ['USD', 'EUR']  <span class="cm"># Tus monedas</span>

[database]
url = "sqlite:///config/mostro.db"  <span class="cm"># Ruta de la base de datos dentro del contenedor</span></code></pre>
</div>

<p>Guardar: <code>Ctrl+X</code>, luego <code>Y</code>, luego <code>Enter</code>.</p>

<h4>Paso 8: Construir la imagen Docker</h4>

<p>Necesitas proporcionar las variables de entorno <code>LND_CERT_FILE</code> y <code>LND_MACAROON_FILE</code> que apunten a tus archivos LND. Estos ser√°n copiados a <code>config/lnd/</code> durante la construcci√≥n.</p>

<div class="callout warning">
  <div class="callout-title">üìÅ Directorio de trabajo</div>
  Regresa al directorio ra√≠z del repositorio antes de ejecutar los comandos make:
</div>

<p><strong>Linux/macOS:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>cd ..
LND_CERT_FILE=~/.polar/networks/1/volumes/lnd/alice/tls.cert \
LND_MACAROON_FILE=~/.polar/networks/1/volumes/lnd/alice/data/chain/bitcoin/regtest/admin.macaroon \
make docker-build</code></pre>
</div>

<p><strong>Windows PowerShell:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>powershell</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>cd ..
$env:LND_CERT_FILE="C:\Users\TuUsuario\.polar\networks\1\volumes\lnd\alice\tls.cert"
$env:LND_MACAROON_FILE="C:\Users\TuUsuario\.polar\networks\1\volumes\lnd\alice\data\chain\bitcoin\regtest\admin.macaroon"
make docker-build</code></pre>
</div>

<p><strong>Alternativa:</strong> Exporta las variables para tu sesi√≥n:</p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>cd ..
export LND_CERT_FILE=~/.polar/networks/1/volumes/lnd/alice/tls.cert
export LND_MACAROON_FILE=~/.polar/networks/1/volumes/lnd/alice/data/chain/bitcoin/regtest/admin.macaroon
make docker-build</code></pre>
</div>

<p>Si LND est√° en la <strong>misma m√°quina</strong>, las rutas t√≠picas son:</p>
<ul>
  <li><code>/root/.lnd/tls.cert</code></li>
  <li><code>/root/.lnd/data/chain/bitcoin/mainnet/admin.macaroon</code></li>
</ul>

<p>Si LND est√° en una <strong>m√°quina diferente</strong>, copia los archivos a tu sistema local primero, luego apunta las variables de entorno a esas copias locales.</p>

<h4>Paso 9: Configurar Contrase√±a de Base de Datos (Opcional)</h4>
<p>Para modo no interactivo (ejecutando <code>docker compose up -d</code>), configura <code>MOSTRO_DB_PASSWORD</code> en <code>docker/.env</code>:</p>

<div class="callout warning">
  <div class="callout-title">üîí Advertencia de Seguridad</div>
  El repositorio ya incluye <code>docker/.env</code> en <code>.gitignore</code> para evitar comprometer accidentalmente credenciales sensibles en el control de versiones.
</div>

<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Crear archivo docker/.env</span>
nano docker/.env</code></pre>
</div>

<p>Agrega una de estas opciones:</p>

<div class="code-block">
  <div class="code-block-header"><span>dotenv</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Usa una contrase√±a fuerte para habilitar encriptaci√≥n de BD</span>
MOSTRO_DB_PASSWORD='Str0ngPassw0rd!'</code></pre>
</div>

<div class="code-block">
  <div class="code-block-header"><span>dotenv</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># O config√∫ralo vac√≠o para omitir encriptaci√≥n de BD</span>
MOSTRO_DB_PASSWORD=</code></pre>
</div>

<h4>Paso 10: Iniciar Mostro</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Iniciar Mostro y el relay Nostr local</span>
make docker-up</code></pre>
</div>

<p>Verifica que todo est√© funcionando:</p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>docker compose -f docker/compose.yml ps</code></pre>
</div>

<h4>Paso 11: Revisar los logs</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>docker compose -f docker/compose.yml logs -f mostro</code></pre>
</div>

<p>Busca estos mensajes:</p>
<ul>
  <li><code>Settings correctly loaded</code> ‚Äî La configuraci√≥n es v√°lida</li>
  <li><code>Connected to LND</code> ‚Äî Conexi√≥n Lightning exitosa</li>
  <li><code>Connected to relay</code> ‚Äî Relay Nostr establecido</li>
</ul>

<h4>Detener y reiniciar</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>make docker-down   <span class="cm"># Detener</span>
make docker-up     <span class="cm"># Iniciar</span></code></pre>
</div>

<p>üéâ <strong>¬°Felicitaciones!</strong> Si ves conexiones exitosas en los logs, ¬°tu nodo Mostro est√° funcionando!</p>

<hr>

<h4>Soluci√≥n de Problemas Comunes de Docker</h4>

<details class="collapsible" id="solucion-problemas-docker">
<summary><strong>Problemas Frecuentes y Soluciones</strong></summary>
<div class="collapsible-content">

<h5>‚ùå Error: Permission denied (os error 13)</h5>

<div class="callout warning">
  <div class="callout-title">üõ†Ô∏è Problema de Permisos de Base de Datos</div>
  SQLite necesita permisos de escritura tanto en el archivo de base de datos como en el directorio padre para crear archivos temporales (<code>.db-wal</code>, <code>.db-shm</code>).
</div>

<p><strong>Arreglo R√°pido:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Arreglar permisos antes de iniciar</span>
sudo chown -R 1000:1000 ./config/
sudo chmod 700 ./config/
sudo chmod 600 ./config/settings.toml
sudo chmod -R 700 ./config/lnd/

<span class="cm"># Luego iniciar normalmente</span>
make docker-up</code></pre>
</div>

<p><strong>Arreglo Permanente en docker/compose.yml:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>yaml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>services:
  mostro:
    # ... configuraci√≥n existente ...
    user: "1000:1000"  # Ejecutar como usuario no-root
    volumes:
      - ./config:/config:rw  # Asegurar acceso de lectura-escritura</code></pre>
</div>

<h5>‚ùå Problemas de creaci√≥n de archivo de base de datos</h5>

<p><strong>Asegurar estructura de directorio correcta:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Crear directorio con permisos apropiados</span>
mkdir -p docker/config
sudo chown -R $(id -u):$(id -g) docker/config
chmod 755 docker/config

<span class="cm"># Verificar permisos</span>
ls -la docker/config/</code></pre>
</div>

<p><strong>Pasos de debug:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Verificar usuario del contenedor</span>
docker compose exec mostro whoami

<span class="cm"># Verificar permisos del directorio montado dentro del contenedor</span>
docker compose exec mostro ls -la /config

<span class="cm"># Arreglar permisos desde el host (no desde dentro del contenedor)</span>
sudo chown -R 1000:1000 ./config/</code></pre>
</div>

</div>
</details>
</div>
</details>

<!-- Option C: Native -->
<details class="collapsible" id="opcion-c-nativo">
<summary>Opci√≥n C: Compilaci√≥n Nativa (Para operadores t√©cnicos)</summary>
<div class="collapsible-content">

<h4>Paso 5: Instalar Rust</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Instalar Rust (presiona 1 cuando se te pregunte)</span>
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

<span class="cm"># Hacer Rust disponible en la sesi√≥n actual</span>
source /root/.cargo/env

<span class="cm"># Verificar</span>
rustc --version   <span class="cm"># Esperado: rustc 1.86.0+</span>
cargo --version   <span class="cm"># Esperado: cargo 1.86.0+</span></code></pre>
</div>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Importante</div>
  NO instales Rust via <code>apt install rustc</code>. Siempre usa <code>rustup</code> como se muestra arriba. El paquete del sistema suele estar desactualizado y causar√° errores de compilaci√≥n.
</div>

<h4>Paso 6: Instalar dependencias de compilaci√≥n</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>apt install -y cmake build-essential libsqlite3-dev libssl-dev pkg-config git sqlite3 protobuf-compiler</code></pre>
</div>

<h4>Paso 7: Descargar y compilar Mostro</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>cd /opt
git clone https://github.com/MostroP2P/mostro.git
cd mostro

<span class="cm"># Compilar en modo release (10-20 minutos en un VPS peque√±o)</span>
cargo build --release</code></pre>
</div>

<div class="callout tip">
  <div class="callout-title">üí° Consejo</div>
  Si la compilaci√≥n falla por falta de RAM, agrega espacio swap:
  <div class="code-block" style="margin-top:10px">
    <pre><code>fallocate -l 2G /swapfile
chmod 600 /swapfile
mkswap /swapfile
swapon /swapfile</code></pre>
  </div>
</div>

<h4>Paso 8: Instalar el binario</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>install target/release/mostrod /usr/local/bin
mostrod --version</code></pre>
</div>

<h4>Paso 9: Inicializar la base de datos</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>cargo install sqlx-cli --version 0.6.2
./init_db.sh</code></pre>
</div>

<h4>Paso 10: Limpiar archivos de compilaci√≥n</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>cargo clean  <span class="cm"># Ahorra 2+ GB de espacio en disco</span></code></pre>
</div>

<h4>Paso 11: Crear un usuario dedicado</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>adduser --disabled-login mostro</code></pre>
</div>

<h4>Paso 12: Configurar Mostro</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>mkdir -p /opt/mostro
cp /opt/mostro/settings.tpl.toml /opt/mostro/settings.toml
nano /opt/mostro/settings.toml</code></pre>
</div>

<p>Edita los mismos ajustes que en la Opci√≥n A, Paso 8: <code>lnd_cert_file</code>, <code>lnd_macaroon_file</code>, <code>lnd_grpc_host</code>, <code>nsec_privkey</code>, <code>relays</code>, <code>fee</code>, <code>fiat_currencies_accepted</code>, etc.</p>

<h4>Paso 13: Prueba de ejecuci√≥n</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>/usr/local/bin/mostrod -d /opt/mostro</code></pre>
</div>
<p>Si se conecta a LND y los relays exitosamente, presiona <code>Ctrl+C</code> para detenerlo.</p>

<h4>Paso 14: Establecer permisos de archivos</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>chown -R mostro:mostro /opt/mostro</code></pre>
</div>

<h4>Paso 15: Configurar como servicio del sistema</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>nano /etc/systemd/system/mostro.service</code></pre>
</div>

<p>Pega este contenido:</p>
<div class="code-block">
  <div class="code-block-header"><span>ini</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>[Unit]
Description=Mostro daemon
After=network.target

[Service]
Type=simple
User=mostro
WorkingDirectory=/home/mostro
Environment=RUST_LOG=info
ExecStart=/usr/local/bin/mostrod -d /opt/mostro
Restart=on-failure

[Install]
WantedBy=multi-user.target</code></pre>
</div>

<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>systemctl daemon-reload
systemctl enable mostro.service
systemctl start mostro.service
systemctl status mostro.service</code></pre>
</div>

<h4>Paso 16: Verificar</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>ps aux | grep mostrod
journalctl -u mostro -f</code></pre>
</div>

<p>üéâ <strong>¬°Felicitaciones!</strong> Tu nodo Mostro est√° funcionando como servicio del sistema y se reiniciar√° autom√°ticamente despu√©s de reinicios.</p>

</div>
</details>

<hr>

<!-- ============================================================ -->
<h2 id="configuracion">4. Configuraci√≥n en Detalle</h2>

<p>El archivo <code>settings.toml</code> controla todo sobre tu nodo Mostro.</p>

<h3 id="cfg-nostr">4.1 Claves Nostr ‚Äî La identidad de tu nodo</h3>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>[nostr]
nsec_privkey = 'YOUR_NSEC_PRIVATE_KEY'
relays = [
  'wss://relay.mostro.network',
  'wss://nos.lol',
  'wss://relay.nostr.band'
]</code></pre>
</div>

<p><strong>Generando claves Nostr:</strong></p>
<ul>
  <li><strong>rana</strong> (CLI): <code>cargo install rana && rana</code> ‚Äî <strong>Recomendado:</strong> local, seguro, soporta generaci√≥n de claves vanity</li>
  <li>Cualquier cliente Nostr (Damus, Amethyst, etc.) ‚Äî para casos de uso menos cr√≠ticos</li>
</ul>

<div class="callout warning">
  <div class="callout-title">üîí Nota de Seguridad</div>
  Para aplicaciones cr√≠ticas como nodos Mostro, siempre genera claves localmente usando herramientas como <code>rana</code>. Nunca uses generadores de claves online para infraestructura importante.
</div>

<p><strong>¬øQu√© relays usar?</strong></p>
<ul>
  <li><code>wss://relay.mostro.network</code> ‚Äî Relay propio de Mostro, recomendado</li>
  <li><code>wss://nos.lol</code> ‚Äî Relay confiable y bien conectado</li>
  <li>Agrega 3‚Äì5 relays para fiabilidad. M√°s relays = mejor disponibilidad pero m√°s ancho de banda.</li>
</ul>

<div class="callout tip">
  <div class="callout-title">üí° Consejo</div>
  Tambi√©n puedes ejecutar tu propio relay Nostr junto a Mostro (la instalaci√≥n Docker incluye uno por defecto).
</div>

<h3 id="cfg-comisiones">4.2 Comisiones ‚Äî C√≥mo generas ingresos</h3>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>[mostro]
fee = 0.006
dev_fee_percentage = 0.30</code></pre>
</div>

<p><strong>Comisi√≥n de trading (<code>fee</code>):</strong> Porcentaje cobrado por operaci√≥n, dividido entre comprador y vendedor.</p>
<ul>
  <li><code>0.006</code> = 0.6% (cada parte paga 0.3%)</li>
  <li><code>0.01</code> = 1.0% (cada parte paga 0.5%)</li>
  <li><code>0</code> = gratis (bueno para hacer crecer tu base de usuarios)</li>
</ul>

<p><strong>Ejemplo:</strong> En una operaci√≥n de 100,000 sats con <code>fee = 0.006</code>: El comprador paga 300 sats, el vendedor paga 300 sats, tu nodo gana 600 sats en total.</p>

<p><strong>Comisi√≥n de desarrollo (<code>dev_fee_percentage</code>):</strong> Un porcentaje de <em>tus</em> ganancias por comisiones que va al desarrollo de Mostro.</p>
<ul>
  <li><code>0.30</code> = 30% (por defecto) ‚Äî de 600 sats, 180 van al fondo de desarrollo</li>
  <li>M√≠nimo: 10% (<code>0.10</code>), M√°ximo: 100% (<code>1.0</code>)</li>
  <li>Lo paga tu nodo de sus ganancias, no se cobra a los usuarios</li>
  <li>Todos los pagos de comisi√≥n de desarrollo son auditables p√∫blicamente a trav√©s de eventos Nostr (kind 8383)</li>
</ul>

<div class="callout note">
  <div class="callout-title">üìù Nota</div>
  Establecer <code>dev_fee_percentage</code> por debajo de <code>0.10</code> impedir√° que Mostro arranque. Este m√≠nimo asegura financiamiento sostenible del desarrollo.
</div>

<h3 id="cfg-limites">4.3 L√≠mites de √≥rdenes y monedas</h3>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>[mostro]
max_order_amount = 1000000
min_payment_amount = 100
fiat_currencies_accepted = ['USD', 'EUR', 'ARS', 'CUP']</code></pre>
</div>

<ul>
  <li><strong><code>max_order_amount</code>:</strong> Operaci√≥n m√°s grande en satoshis. Config√∫ralo bas√°ndote en tu capacidad de canales Lightning. Empieza de forma conservadora.</li>
  <li><strong><code>min_payment_amount</code>:</strong> Operaci√≥n m√≠nima en satoshis. 1,000 o 10,000 es m√°s pr√°ctico que 100.</li>
  <li><strong><code>fiat_currencies_accepted</code>:</strong> Usa <a href="https://en.wikipedia.org/wiki/ISO_4217" target="_blank" rel="noopener noreferrer">c√≥digos ISO 4217</a>. Array vac√≠o <code>[]</code> acepta todas las monedas.</li>
</ul>

<h3 id="cfg-perfil">4.4 Perfil del nodo (Opcional pero recomendado)</h3>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>[mostro]
name = "LatAm Mostro"
about = "Exchange P2P de Bitcoin para Latinoam√©rica. Soporte en espa√±ol."
picture = "https://ejemplo.com/tu-logo.png"
website = "https://sitio-de-tu-comunidad.com"</code></pre>
</div>

<p>Estos configuran el perfil de tu Mostro en Nostr (NIP-01 kind 0 metadata). Los clientes muestran esta informaci√≥n para que los usuarios sepan en qu√© Mostro est√°n operando.</p>

<h3 id="cfg-tiempos">4.5 Tiempos y expiraci√≥n</h3>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>[mostro]
expiration_hours = 24
expiration_seconds = 900
hold_invoice_expiration_window = 300</code></pre>
</div>

<ul>
  <li><strong><code>expiration_hours</code>:</strong> Cu√°nto tiempo una orden permanece abierta (24h por defecto)</li>
  <li><strong><code>expiration_seconds</code>:</strong> Tiempo para que el tomador complete su acci√≥n (900s = 15 min)</li>
  <li><strong><code>hold_invoice_expiration_window</code>:</strong> Validez de la hold invoice (300s = 5 min)</li>
</ul>

<h3 id="cfg-antispam">4.6 Anti-Spam</h3>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>[mostro]
pow = 0</code></pre>
</div>

<p><strong>Proof of Work:</strong> <code>0</code> = deshabilitado; <code>10-20</code> = moderado (recomendado si experimentas spam). Empieza con <code>0</code>.</p>

<h3 id="cfg-rpc">4.7 Interfaz RPC Admin (Opcional)</h3>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>[rpc]
enabled = false
listen_address = "127.0.0.1"
port = 50051</code></pre>
</div>

<p>Habil√≠tala para herramientas de administraci√≥n como MostriX (interfaz de terminal) para resoluci√≥n de disputas.</p>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Seguridad</div>
  Si habilitas RPC, mant√©n <code>listen_address</code> como <code>"127.0.0.1"</code> (solo localhost). Nunca expongas esto a internet.
</div>

<hr>

<!-- ============================================================ -->
<h2 id="operacion">5. Operando Tu Nodo Mostro</h2>

<h3 id="disputas">5.1 C√≥mo funcionan las disputas</h3>

<p>Las disputas son tu responsabilidad operativa m√°s importante.</p>

<p><strong>¬øCu√°ndo ocurren las disputas?</strong></p>
<ul>
  <li>El comprador dice que envi√≥ el pago, el vendedor dice que no lo recibi√≥</li>
  <li>El vendedor se niega a liberar Bitcoin despu√©s de recibir el pago</li>
  <li>Alguna de las partes deja de responder</li>
</ul>

<p><strong>El proceso de disputa:</strong></p>
<ol>
  <li><strong>Un usuario abre una disputa</strong> ‚Äî Cualquiera de las partes presiona "Disputa" en su cliente</li>
  <li><strong>Mostro marca la orden</strong> ‚Äî El estado cambia a "Disputa", los fondos permanecen bloqueados</li>
  <li><strong>Un √°rbitro toma el caso</strong> ‚Äî Un admin (√°rbitro/solver) asignado a tu nodo investiga</li>
  <li><strong>Investigaci√≥n</strong> ‚Äî Se comunica con ambas partes, solicita evidencia</li>
  <li><strong>Resoluci√≥n</strong> ‚Äî El √°rbitro decide: liquidar al vendedor, o cancelar/reembolsar al comprador</li>
</ol>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Importante</div>
  Elige a los √°rbitros cuidadosamente. Tienen el poder de decidir a d√≥nde van los fondos bloqueados. Elige miembros de confianza e imparciales de tu comunidad. Se recomiendan 2‚Äì3 √°rbitros.
</div>

<h3 id="mostrix">5.2 Mostrix ‚Äî Tu herramienta de administraci√≥n para resoluci√≥n de disputas</h3>

<p><a href="https://github.com/MostroP2P/mostrix" target="_blank" rel="noopener noreferrer"><strong>Mostrix</strong></a> es un cliente de terminal (TUI) para Mostro. Actualmente es la <strong>√∫nica herramienta disponible para resoluci√≥n de disputas</strong> por parte de los operadores de nodos. Si oper√°s un nodo Mostro, necesit√°s Mostrix.</p>

<p><strong>Qu√© hace:</strong></p>
<ul>
  <li>Navegar e interactuar con √≥rdenes en tu nodo Mostro</li>
  <li><strong>Tomar disputas</strong> ‚Äî reclamar una disputa para que otros admins sepan que la est√°s manejando</li>
  <li><strong>Chatear con ambas partes</strong> ‚Äî comunicarte con comprador y vendedor en una vista dividida</li>
  <li><strong>Resolver disputas</strong> ‚Äî "Pagar al Comprador" (liberar sats al comprador) o "Reembolsar al Vendedor" (devolver sats al vendedor)</li>
  <li><strong>Gestionar solvers</strong> ‚Äî agregar otros resolvedores de disputas desde la interfaz de administraci√≥n</li>
</ul>

<h4>Instalaci√≥n de Mostrix</h4>
<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Prerequisito: Rust/Cargo requerido</div>
  Mostrix debe compilarse desde el c√≥digo fuente. Si seguiste la Opci√≥n A o B (Docker), puede que no tengas Rust instalado. Sigue el <a href="#opcion-c-nativo">Opci√≥n C, Paso 5</a> para instalar Rust v√≠a rustup antes de continuar.
</div>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Instalar dependencias (Ubuntu/Debian)</span>
sudo apt update
sudo apt install -y cmake build-essential pkg-config

<span class="cm"># Clonar y compilar</span>
git clone https://github.com/MostroP2P/mostrix.git
cd mostrix
cargo build --release

<span class="cm"># Ejecutar</span>
cargo run</code></pre>
</div>

<p>En la primera ejecuci√≥n, Mostrix crea <code>~/.mostrix/settings.toml</code>. Edit√° este archivo para configurarlo.</p>

<h4>Configuraci√≥n de Mostrix en modo administrador</h4>
<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Clave p√∫blica de tu nodo Mostro (formato hex)</span>
mostro_pubkey = "YOUR_MOSTRO_PUBKEY_HEX"

<span class="cm"># Tu clave privada personal de Nostr</span>
nsec_privkey = "nsec1your_personal_key"

<span class="cm"># Tu clave privada de ADMIN ‚Äî debe coincidir con una clave de solver registrada en el nodo</span>
admin_privkey = "nsec1your_admin_key"

<span class="cm"># Los relays que usa tu nodo Mostro</span>
relays = [
  "wss://relay.mostro.network",
  "wss://nos.lol",
  "wss://relay.nostr.band"
]

<span class="cm"># Monedas fiat que quer√©s ver</span>
currencies = ["USD", "EUR", "ARS"]

<span class="cm"># IMPORTANTE: Configurar como "admin" para habilitar funciones de resoluci√≥n de disputas</span>
user_mode = "admin"</code></pre>
</div>

<div class="callout tip">
  <div class="callout-title">üí° Distinci√≥n clave</div>
  <code>nsec_privkey</code> es tu clave personal de Nostr (para firmar eventos). <code>admin_privkey</code> es la clave que otorga privilegios de administrador ‚Äî debe estar registrada como solver en el nodo Mostro.
</div>

<h4>Resoluci√≥n de disputas con Mostrix</h4>
<ol>
  <li><strong>Pesta√±a Disputes Pending</strong> ‚Äî Muestra todas las disputas con estado "Initiated". Seleccion√° una y presion√° <strong>Enter</strong> para tomarla (otros admins ver√°n que la reclamaste).</li>
  <li><strong>Pesta√±a Disputes in Progress</strong> ‚Äî Tu espacio de trabajo. Cada disputa muestra:
    <ul>
      <li>Informaci√≥n completa de la disputa (comprador, vendedor, montos, moneda, calificaciones)</li>
      <li>Vista de chat dividida ‚Äî presion√° <strong>Tab</strong> para alternar entre el chat del comprador y vendedor</li>
      <li>Presion√° <strong>Shift+I</strong> para habilitar la entrada de chat, escrib√≠ tu mensaje</li>
      <li>Us√° <strong>PageUp/PageDown</strong> para desplazarte, <strong>End</strong> para ir al √∫ltimo mensaje</li>
    </ul>
  </li>
  <li><strong>Finalizar</strong> ‚Äî Presion√° <strong>Shift+F</strong> para abrir el popup de finalizaci√≥n:
    <ul>
      <li><strong>Pay Buyer</strong> ‚Äî Liberar los sats bloqueados al comprador (usar cuando el vendedor recibi√≥ el fiat pero no libera)</li>
      <li><strong>Refund Seller</strong> ‚Äî Cancelar la hold invoice, devolviendo sats al vendedor (usar cuando el comprador no pag√≥ realmente)</li>
      <li><strong>Exit</strong> ‚Äî Cerrar sin acci√≥n si necesit√°s m√°s tiempo</li>
    </ul>
  </li>
  <li>Una vez finalizada, la disputa se cierra y no puede modificarse.</li>
</ol>

<div class="callout note">
  <div class="callout-title">üìù Nota</div>
  Mostrix todav√≠a est√° en desarrollo. Algunas funciones como chat peer-to-peer y cancelaci√≥n cooperativa a√∫n no est√°n implementadas. Pero el flujo principal de resoluci√≥n de disputas es completamente funcional.
</div>

<h3 id="watchdog">5.3 mostro-watchdog ‚Äî Notificaciones de disputas en Telegram</h3>

<p><a href="https://github.com/MostroP2P/mostro-watchdog" target="_blank" rel="noopener noreferrer"><strong>mostro-watchdog</strong></a> es un bot de notificaciones que monitorea tu nodo Mostro en busca de disputas y env√≠a alertas instant√°neas a un grupo de Telegram. Esto es esencial para tiempos de respuesta r√°pidos ‚Äî no quer√©s estar constantemente mirando Mostrix esperando disputas.</p>

<p><strong>C√≥mo funciona:</strong></p>
<div class="code-block">
  <div class="code-block-header"><span>Flujo</span></div>
  <pre><code>Mostro daemon ‚Üí Nostr (kind 38386) ‚Üí mostro-watchdog ‚Üí Alerta en Telegram üö®</code></pre>
</div>

<p>Cuando un usuario abre una disputa, tu grupo de Telegram de admins recibe una notificaci√≥n instant√°nea como:</p>
<div class="code-block">
  <div class="code-block-header"><span>Alerta de Telegram</span></div>
  <pre><code>üö® NEW DISPUTE

üìã Dispute ID: abc123def456
üë§ Initiated by: buyer
‚è∞ Time: 2026-02-11 18:30:00 UTC

‚ö° Please take this dispute in Mostrix or your admin client.</code></pre>
</div>

<h4>Instalaci√≥n de mostro-watchdog</h4>
<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Prerequisito: Rust/Cargo requerido</div>
  Al igual que Mostrix, mostro-watchdog debe compilarse desde el c√≥digo fuente. Aseg√∫rate de tener Rust instalado (<a href="#opcion-c-nativo">Opci√≥n C, Paso 5</a>).
</div>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>git clone https://github.com/MostroP2P/mostro-watchdog.git
cd mostro-watchdog
cargo build --release</code></pre>
</div>

<h4>Configuraci√≥n de mostro-watchdog</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>cp config.example.toml config.toml
nano config.toml</code></pre>
</div>

<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>[mostro]
<span class="cm"># Clave p√∫blica Nostr de tu daemon Mostro</span>
pubkey = "YOUR_MOSTRO_PUBKEY"

[nostr]
<span class="cm"># Los mismos relays que usa tu daemon Mostro</span>
relays = ["wss://relay.mostro.network", "wss://nos.lol", "wss://relay.nostr.band"]

[telegram]
<span class="cm"># Obten√© esto de @BotFather en Telegram</span>
bot_token = "YOUR_BOT_TOKEN"

<span class="cm"># El ID del grupo/canal de Telegram para alertas de admin</span>
chat_id = "YOUR_CHAT_ID"</code></pre>
</div>

<p><strong>Configuraci√≥n del bot de Telegram:</strong></p>
<ol>
  <li>Envi√° un mensaje a <a href="https://t.me/BotFather" target="_blank" rel="noopener noreferrer">@BotFather</a> en Telegram ‚Üí <code>/newbot</code> ‚Üí segu√≠ las instrucciones</li>
  <li>Copi√° el token del bot a <code>config.toml</code></li>
  <li>Cre√° un <strong>grupo privado de Telegram</strong> para tu equipo de administraci√≥n</li>
  <li>Agreg√° el bot al grupo</li>
  <li>Obten√© el chat ID (envi√° un mensaje en el grupo, luego revis√° <code>https://api.telegram.org/bot&lt;YOUR_TOKEN&gt;/getUpdates</code>)</li>
</ol>

<h4>Ejecuci√≥n de mostro-watchdog</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Ejecutar con configuraci√≥n por defecto</span>
./target/release/mostro-watchdog

<span class="cm"># Ruta de configuraci√≥n personalizada</span>
./target/release/mostro-watchdog /path/to/config.toml

<span class="cm"># Con logging de debug</span>
RUST_LOG=mostro_watchdog=debug ./target/release/mostro-watchdog</code></pre>
</div>

<div class="callout tip">
  <div class="callout-title">üí° Consejo</div>
  Ejecut√° mostro-watchdog como un servicio systemd (igual que Mostro) para que se inicie autom√°ticamente y funcione 24/7. Tus admins nunca deber√≠an perderse una notificaci√≥n de disputa.
</div>

<h4>El flujo completo de disputas</h4>
<p>Poniendo todo junto, el flujo completo para un operador de nodo es:</p>
<ol>
  <li><strong>mostro-watchdog</strong> detecta una nueva disputa ‚Üí env√≠a alerta de Telegram a tu grupo de admins</li>
  <li>El admin ve la alerta en su tel√©fono/escritorio</li>
  <li>El admin abre <strong>Mostrix</strong> en modo administrador</li>
  <li>El admin va a <strong>Disputes Pending</strong> ‚Üí toma la disputa</li>
  <li>El admin investiga mediante chat con comprador y vendedor en <strong>Disputes in Progress</strong></li>
  <li>El admin resuelve con <strong>Pay Buyer</strong> o <strong>Refund Seller</strong></li>
  <li>Listo ‚Äî disputa cerrada, usuarios notificados autom√°ticamente</li>
</ol>

<p>Este flujo asegura tiempos de respuesta r√°pidos y responsabilidad clara.</p>

<h3 id="monitoreo">5.4 Monitoreo de uptime</h3>

<p>Tu nodo necesita estar funcionando 24/7.</p>

<div class="code-block">
  <div class="code-block-header"><span>bash ‚Äî Nativo</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>systemctl status mostro.service
journalctl -u mostro -f
journalctl -u mostro | grep -E "(error|warn|connected)" --ignore-case</code></pre>
</div>

<div class="code-block">
  <div class="code-block-header"><span>bash ‚Äî Docker</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>docker compose -f /opt/mostro/docker/compose.yml ps
docker compose -f /opt/mostro/docker/compose.yml logs -f mostro</code></pre>
</div>

<div class="callout tip">
  <div class="callout-title">üí° Consejo pro</div>
  Configura un monitor de uptime simple usando <a href="https://uptimerobot.com/" target="_blank" rel="noopener noreferrer">UptimeRobot</a> (nivel gratuito) o un cron job que te alerte si Mostro se cae.
</div>

<h3 id="actualizacion">5.5 Actualizando Mostro</h3>

<details class="collapsible">
<summary>Actualizaci√≥n Docker</summary>
<div class="collapsible-content">
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>cd /opt/mostro
git pull origin main
make docker-build
make docker-down
make docker-up</code></pre>
</div>
</div>
</details>

<details class="collapsible">
<summary>Actualizaci√≥n Docker Hub</summary>
<div class="collapsible-content">
<p>Para Docker Hub, <code>docker restart</code> no actualiza la imagen. Debes recrear el contenedor despu√©s de hacer pull del nuevo tag.</p>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># 1) Elegir el tag a desplegar (evitar :latest en producci√≥n)</span>
export MOSTRO_TAG=v0.16.3

<span class="cm"># 2) Detener y remover el contenedor actual</span>
docker stop mostro
docker rm mostro

<span class="cm"># 3) Descargar la nueva imagen</span>
docker pull mostrop2p/mostro:${MOSTRO_TAG}

<span class="cm"># 4A) Recrear (LND en el mismo VPS)</span>
docker run -d --name mostro \
  --restart unless-stopped \
  --add-host=host.docker.internal:host-gateway \
  -v ~/mostro-config:/config \
  mostrop2p/mostro:${MOSTRO_TAG}

<span class="cm"># 4B) Recrear (LND en servidor diferente)</span>
docker run -d --name mostro \
  --restart unless-stopped \
  -v ~/mostro-config:/config \
  mostrop2p/mostro:${MOSTRO_TAG}

<span class="cm"># Verificar versi√≥n en ejecuci√≥n</span>
docker inspect --format '{{.Config.Image}}' mostro</code></pre>
</div>
<p>Si usas Compose para Docker Hub, el flujo equivalente es: <code>docker compose pull && docker compose up -d</code>.</p>
</div>
</details>

<details class="collapsible">
<summary>Actualizaci√≥n nativa</summary>
<div class="collapsible-content">
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>cd /opt/mostro
git pull origin main
cargo build --release
install target/release/mostrod /usr/local/bin
cargo clean
cargo install sqlx-cli --version 0.6.2
sqlx migrate run
systemctl restart mostro.service</code></pre>
</div>
</div>
</details>

<div class="callout tip">
  <div class="callout-title">üí° Consejo</div>
  Siempre respalda tu base de datos antes de actualizar.
</div>

<h3 id="respaldos">5.6 Respaldos</h3>

<p>Archivos cr√≠ticos a respaldar: <code>settings.toml</code> (¬°contiene tu clave privada Nostr!) y <code>mostro.db</code> (historial de √≥rdenes, reputaciones).</p>

<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Respaldo manual ‚Äî Docker (build desde repo):</span>
mkdir -p /root/mostro-backups
cp /opt/mostro/docker/config/settings.toml /root/mostro-backups/settings.toml.$(date +%Y%m%d)
cp /opt/mostro/docker/config/mostro.db /root/mostro-backups/mostro.db.$(date +%Y%m%d)

<span class="cm"># Respaldo manual ‚Äî Docker Hub deployment:</span>
cp ~/mostro-config/settings.toml /root/mostro-backups/settings.toml.$(date +%Y%m%d)
cp ~/mostro-config/mostro.db /root/mostro-backups/mostro.db.$(date +%Y%m%d)

<span class="cm"># Respaldo manual ‚Äî Nativo:</span>
cp /opt/mostro/settings.toml /root/mostro-backups/settings.toml.$(date +%Y%m%d)
cp /opt/mostro/mostro.db /root/mostro-backups/mostro.db.$(date +%Y%m%d)</code></pre>
</div>

<p><strong>Respaldo diario automatizado</strong> (agregar al crontab con <code>crontab -e</code>):</p>
<div class="code-block">
  <div class="code-block-header"><span>cron</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>0 3 * * * cp /opt/mostro/mostro.db /root/mostro-backups/mostro.db.$(date +\%Y\%m\%d)</code></pre>
</div>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Cr√≠tico</div>
  Tu <code>nsec_privkey</code> en <code>settings.toml</code> ES la identidad de tu nodo. Si la pierdes, pierdes tu reputaci√≥n y todos los usuarios deben reconectarse a una nueva identidad. <strong>Guarda una copia offline.</strong>
</div>

<h3 id="actividad">5.7 Revisando la actividad de operaciones</h3>

<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code><span class="cm"># Contar todas las √≥rdenes</span>
sqlite3 /ruta/a/mostro.db "SELECT COUNT(*) FROM orders;"

<span class="cm"># Operaciones exitosas recientes</span>
sqlite3 /ruta/a/mostro.db "SELECT id, fiat_amount, fiat_code, amount, status, created_at FROM orders WHERE status = 'success' ORDER BY created_at DESC LIMIT 10;"

<span class="cm"># √ìrdenes pendientes</span>
sqlite3 /ruta/a/mostro.db "SELECT id, fiat_amount, fiat_code, status FROM orders WHERE status = 'pending';"

<span class="cm"># Ingresos totales por comisiones</span>
sqlite3 /ruta/a/mostro.db "SELECT SUM(fee * 2) as total_fees_sats FROM orders WHERE status = 'success';"</code></pre>
</div>

<hr>

<!-- ============================================================ -->
<h2 id="costos">6. Desglose de Costos</h2>

<h3>Costos operativos mensuales</h3>
<div class="table-wrapper">
<table>
  <thead><tr><th>Concepto</th><th>Costo mensual</th><th>Notas</th></tr></thead>
  <tbody>
    <tr><td>VPS (servidor)</td><td>$10‚Äì24</td><td>Depende del proveedor y las especificaciones</td></tr>
    <tr><td>Nombre de dominio (opcional)</td><td>$1‚Äì2</td><td>Para un sitio web/identidad</td></tr>
    <tr><td>Comisiones on-chain de canales Lightning</td><td>Variable</td><td>Apertura/cierre de canales</td></tr>
    <tr><td><strong>Total mensual</strong></td><td><strong>$11‚Äì26</strong></td><td>Excluyendo liquidez Lightning</td></tr>
  </tbody>
</table>
</div>

<h3>Costos √∫nicos / de capital</h3>
<div class="table-wrapper">
<table>
  <thead><tr><th>Concepto</th><th>Costo</th><th>Notas</th></tr></thead>
  <tbody>
    <tr><td>Liquidez Lightning</td><td>0.01‚Äì1.0+ BTC</td><td>Bloqueado en canales; se recupera al cerrar</td></tr>
    <tr><td>Hardware del nodo (si se auto-aloja)</td><td>$0‚Äì600</td><td>Gratis si usas VPS; $300-600 para Start9/Umbrel</td></tr>
    <tr><td>Tiempo de configuraci√≥n</td><td>4‚Äì16 horas</td><td>Dependiendo del nivel de experiencia</td></tr>
  </tbody>
</table>
</div>

<h3>Potencial de ingresos</h3>
<div class="table-wrapper">
<table>
  <thead><tr><th>Volumen mensual de trading</th><th>Comisi√≥n (0.6%)</th><th>Comisi√≥n dev (30%)</th><th>Tu ingreso neto</th></tr></thead>
  <tbody>
    <tr><td>$1,000</td><td>~$6</td><td>~$1.80</td><td>~$4.20</td></tr>
    <tr><td>$10,000</td><td>~$60</td><td>~$18</td><td>~$42</td></tr>
    <tr><td>$50,000</td><td>~$300</td><td>~$90</td><td>~$210</td></tr>
    <tr><td>$100,000</td><td>~$600</td><td>~$180</td><td>~$420</td></tr>
  </tbody>
</table>
</div>

<div class="callout note">
  <div class="callout-title">üìù Realidad</div>
  La mayor√≠a de los nodos nuevos tardan meses en construir volumen de operaciones. No esperes rentabilidad inmediata. El valor real suele venir de proporcionar un servicio a tu comunidad, con las comisiones como bonus.
</div>

<h3>Compromiso de tiempo</h3>
<div class="table-wrapper">
<table>
  <thead><tr><th>Tarea</th><th>Frecuencia</th><th>Tiempo</th></tr></thead>
  <tbody>
    <tr><td>Monitoreo (revisar logs, estado)</td><td>Diario</td><td>5‚Äì10 min</td></tr>
    <tr><td>Resoluci√≥n de disputas</td><td>Seg√∫n necesidad</td><td>15‚Äì60 min por disputa</td></tr>
    <tr><td>Actualizaciones</td><td>Mensual</td><td>15‚Äì30 min</td></tr>
    <tr><td>Gesti√≥n de liquidez</td><td>Semanal</td><td>15‚Äì30 min</td></tr>
    <tr><td><strong>Estimaci√≥n semanal total</strong></td><td></td><td><strong>1‚Äì3 horas</strong></td></tr>
  </tbody>
</table>
</div>

<hr>

<!-- ============================================================ -->
<h2 id="preguntas">7. Preguntas Frecuentes</h2>

<h3>Preguntas generales</h3>

<details class="collapsible">
<summary>¬øNecesito ser desarrollador para ejecutar un nodo Mostro?</summary>
<div class="collapsible-content">
<p>No, pero necesitas sentirte c√≥modo con operaciones b√°sicas de l√≠nea de comandos (escribir comandos, editar archivos de texto). La ruta Docker (Opci√≥n A) est√° dise√±ada para ser accesible. Aunque tener a alguien t√©cnico en tu comunidad ayuda mucho.</p>
</div>
</details>

<details class="collapsible">
<summary>¬øPuedo ejecutar Mostro en una Raspberry Pi?</summary>
<div class="collapsible-content">
<p>T√©cnicamente s√≠ (usando Start9 o similar), pero no se recomienda para producci√≥n debido a la limitaci√≥n de CPU y RAM. Un VPS es m√°s confiable.</p>
</div>
</details>

<details class="collapsible">
<summary>¬øPuedo usar Core Lightning (CLN) en lugar de LND?</summary>
<div class="collapsible-content">
<p>No. Mostro actualmente solo soporta LND, porque depende de la implementaci√≥n espec√≠fica de hold invoices de LND. El soporte para otras implementaciones podr√≠a llegar en el futuro.</p>
</div>
</details>

<details class="collapsible">
<summary>¬øC√≥mo se conectan los usuarios a mi Mostro?</summary>
<div class="collapsible-content">
<p>Los usuarios necesitan una app cliente de Mostro (como Mostro Mobile o mostro-cli) y la clave p√∫blica de tu Mostro (npub). Agregan tu npub a su cliente, y el cliente se comunica a trav√©s de relays Nostr. No se necesita conexi√≥n directa.</p>
</div>
</details>

<details class="collapsible">
<summary>¬øPuedo ejecutar m√∫ltiples instancias de Mostro?</summary>
<div class="collapsible-content">
<p>S√≠, pero cada una necesita su propio par de claves Nostr, nodo LND (o al menos canales/liquidez separados), y configuraci√≥n.</p>
</div>
</details>

<details class="collapsible">
<summary>¬øEs legal?</summary>
<div class="collapsible-content">
<p>Depende mucho de tu jurisdicci√≥n. Mostro es software para trading peer-to-peer. En algunas jurisdicciones, operar un exchange P2P puede requerir licencias. <strong>Consulta las regulaciones locales y asesor√≠a legal.</strong> El proyecto Mostro no proporciona asesor√≠a legal.</p>
</div>
</details>

<h3>Preguntas t√©cnicas</h3>

<details class="collapsible">
<summary>¬øCu√°nto ancho de banda usa Mostro?</summary>
<div class="collapsible-content">
<p>Muy poco ‚Äî principalmente eventos Nostr peque√±os. Unos pocos GB por mes es t√≠pico incluso con volumen moderado de operaciones.</p>
</div>
</details>

<details class="collapsible">
<summary>¬øQu√© pasa si mi nodo se desconecta?</summary>
<div class="collapsible-content">
<p>Las √≥rdenes pendientes eventualmente expiran. Las operaciones activas con fondos bloqueados contin√∫an cuando vuelves a estar online (las hold invoices tienen su propia expiraci√≥n). Si est√°s offline demasiado tiempo, los usuarios pueden perder confianza.</p>
</div>
</details>

<details class="collapsible">
<summary>¬øPuedo cambiar mi clave Nostr despu√©s?</summary>
<div class="collapsible-content">
<p>Puedes, pero perder√°s la identidad y reputaci√≥n de tu nodo. Los usuarios lo ver√°n como un Mostro nuevo. Trata tu clave como tu identidad de marca.</p>
</div>
</details>

<details class="collapsible">
<summary>¬øC√≥mo veo la clave p√∫blica (npub) de mi nodo?</summary>
<div class="collapsible-content">
<p>Der√≠vala de tu nsec usando cualquier herramienta Nostr. Por ejemplo, con <code>mostro-cli</code> o revisando los logs de tu nodo al arrancar (generalmente imprime la clave p√∫blica).</p>
</div>
</details>

<h3>Preguntas financieras</h3>

<details class="collapsible">
<summary>¬øPuedo perder dinero ejecutando un nodo Mostro?</summary>
<div class="collapsible-content">
<p>S√≠, es posible: Los fondos de canales Lightning podr√≠an estar en riesgo por bugs (raro); el cierre forzado de canales durante per√≠odos de comisiones altas puede ser costoso; los costos de VPS son continuos; la inversi√≥n de tiempo es real.</p>
</div>
</details>

<details class="collapsible">
<summary>¬øLa liquidez Lightning est√° "en riesgo"?</summary>
<div class="collapsible-content">
<p>Tu liquidez Lightning es tuya. No est√° en riesgo por Mostro en s√≠ ‚Äî las hold invoices son bloqueos temporales. Sin embargo, aplican los riesgos est√°ndar de Lightning Network (cierres forzados, canales atascados, bugs).</p>
</div>
</details>

<details class="collapsible">
<summary>¬øCu√°ndo alcanzar√© el punto de equilibrio?</summary>
<div class="collapsible-content">
<p>Depende de tus costos y volumen de operaciones. Con $20/mes de costos y 0.6% de comisi√≥n, necesitas ~$5,000/mes en operaciones para cubrir costos (antes de la comisi√≥n de desarrollo). La mayor√≠a de las comunidades tardan 3‚Äì6 meses en alcanzar un volumen significativo.</p>
</div>
</details>

<hr>

<!-- ============================================================ -->
<h2 id="seguridad">8. Consideraciones de Seguridad</h2>

<div class="callout warning">
  <div class="callout-title">‚ö†Ô∏è Aviso de software en etapa temprana</div>
  <p><strong>Mostro est√° en una etapa temprana de desarrollo.</strong> Aunque el equipo trabaja duro para asegurar confiabilidad, puede haber bugs no descubiertos ‚Äî incluyendo bugs de seguridad que podr√≠an resultar en p√©rdida de fondos. <strong>Los desarrolladores no son responsables de ninguna p√©rdida de dinero debido a bugs de software.</strong></p>
  <p>Mostro es open-source y su c√≥digo est√° abierto a auditor√≠as. Animamos a las comunidades a promover y financiar auditor√≠as de seguridad independientes.</p>
  <p>Dicho esto, <strong>el mecanismo central de custodia usando hold invoices de Lightning ha sido probado en batalla desde 2021</strong>, cuando <a href="https://github.com/lnp2pBot/bot" target="_blank" rel="noopener noreferrer">@lnp2pBot</a> implement√≥ por primera vez este tipo de custodia. Miles de operaciones han sido completadas exitosamente usando esta misma l√≥gica.</p>
</div>

<h3>Operando bajo reg√≠menes autoritarios</h3>

<p>Si operas en un pa√≠s con un gobierno autoritario, <strong>la privacidad no es opcional ‚Äî es un requisito de seguridad.</strong></p>

<ol>
  <li><strong>Ejecuta tu nodo Mostro detr√°s de Tor y/o una VPN.</strong> Esto oculta la IP de tu servidor de los relays Nostr.</li>
  <li><strong>Si Tor/VPN no es posible</strong> (com√∫n en pa√≠ses en desarrollo con internet lento), <strong>solo publica eventos en relays que poseas o en los que conf√≠es.</strong></li>
  <li><strong>Ten mucho cuidado con qu√© relays usas.</strong> En el futuro, los gobiernos podr√≠an crear relays Nostr espec√≠ficamente para recolectar direcciones IP.</li>
  <li><strong>Considera tambi√©n la privacidad de tu nodo Lightning.</strong> Ejecutar LND detr√°s de Tor es posible y recomendado en entornos sensibles.</li>
</ol>

<div class="callout tip">
  <div class="callout-title">üí° Consejo</div>
  La belleza de que Mostro sea descentralizado es que incluso si un nodo es apagado, otros siguen funcionando. Pero la prevenci√≥n siempre es mejor que la recuperaci√≥n. Toma la privacidad en serio desde el primer d√≠a.
</div>

<hr>

<!-- ============================================================ -->
<h2 id="solucion-problemas">9. Soluci√≥n de Problemas</h2>

<h3>Mostro no arranca</h3>

<h4>"Configuration error: dev_fee_percentage below minimum"</h4>
<p>Establece <code>dev_fee_percentage</code> en al menos <code>0.10</code> en settings.toml.</p>

<h4>Archivo de configuraci√≥n o base de datos no encontrado</h4>
<p>Aseg√∫rate de que el flag <code>-d</code> apunte al directorio que contiene <code>settings.toml</code>. Para Docker build desde repo: verifica que <code>docker/config/settings.toml</code> exista. Para Docker Hub: verifica que <code>~/mostro-config/settings.toml</code> exista.</p>

<h4>"Failed to connect to LND"</h4>
<ul>
  <li>Verifica que LND est√© ejecut√°ndose: <code>lncli getinfo</code></li>
  <li>Revisa que <code>lnd_grpc_host</code> coincida con la direcci√≥n de tu LND</li>
  <li>Verifica que las rutas de <code>tls.cert</code> y <code>admin.macaroon</code> sean correctas</li>
  <li>Docker + LND en host: usa <code>host.docker.internal</code></li>
</ul>

<h3>Problemas de conexi√≥n</h3>

<h4>Mostro arranca pero no se conecta a los relays</h4>
<ul>
  <li>Verifica las URLs de los relays (deben empezar con <code>wss://</code>)</li>
  <li>Aseg√∫rate de que el firewall de tu VPS permita conexiones salientes en el puerto 443</li>
  <li>Prueba con diferentes relays ‚Äî algunos pueden estar temporalmente ca√≠dos</li>
</ul>

<h3>Problemas con operaciones</h3>

<h4>Las √≥rdenes no aparecen en los clientes</h4>
<ul>
  <li>Verifica las conexiones a relays en los logs</li>
  <li>Aseg√∫rate de que los clientes usen los mismos relays que tu nodo</li>
</ul>

<h4>Pagos fallando</h4>
<ul>
  <li>Revisa la liquidez: <code>lncli listchannels</code></li>
  <li>Aseg√∫rate de tener suficiente capacidad saliente</li>
  <li>Revisa el ajuste <code>max_routing_fee</code></li>
</ul>

<h3>Problemas de base de datos</h3>

<h4>Errores de base de datos bloqueada</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>ps aux | grep mostrod
<span class="cm"># Si hay m√∫ltiples procesos, elimina los extras:</span>
kill &lt;PID&gt;</code></pre>
</div>

<h3>Problemas espec√≠ficos de Docker</h3>

<h4>"Cannot connect to Docker daemon"</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>systemctl start docker</code></pre>
</div>

<h4>La compilaci√≥n falla por falta de memoria</h4>
<div class="code-block">
  <div class="code-block-header"><span>bash</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>fallocate -l 2G /swapfile && chmod 600 /swapfile && mkswap /swapfile && swapon /swapfile</code></pre>
</div>

<h3>Obteniendo ayuda</h3>

<ol>
  <li><strong>Revisa los logs primero</strong> ‚Äî la mayor√≠a de los errores explican qu√© sali√≥ mal</li>
  <li><strong>Telegram (Desarrolladores):</strong> <a href="https://t.me/mostro_dev" target="_blank" rel="noopener noreferrer">@mostro_dev</a></li>
  <li><strong>Telegram (Comunidad):</strong> <a href="https://t.me/MostroP2P" target="_blank" rel="noopener noreferrer">@MostroP2P</a></li>
  <li><strong>GitHub Issues:</strong> <a href="https://github.com/MostroP2P/mostro/issues" target="_blank" rel="noopener noreferrer">github.com/MostroP2P/mostro/issues</a></li>
  <li><strong>DeepWiki:</strong> <a href="https://deepwiki.com/MostroP2P/mostro" target="_blank" rel="noopener noreferrer">deepwiki.com/MostroP2P/mostro</a></li>
</ol>

<p>Cuando pidas ayuda, siempre incluye: tu versi√≥n de Mostro, la salida relevante de los logs, y lo que ya intentaste.</p>

<hr>

<!-- ============================================================ -->
<h2 id="apendice">Ap√©ndice: Referencia R√°pida</h2>

<h3>Ubicaciones importantes de archivos</h3>
<div class="table-wrapper">
<table>
  <thead><tr><th>Archivo</th><th>Docker (build repo)</th><th>Docker Hub</th><th>Nativo</th></tr></thead>
  <tbody>
    <tr><td>Configuraci√≥n</td><td><code>/opt/mostro/docker/config/settings.toml</code></td><td><code>~/mostro-config/settings.toml</code></td><td><code>/opt/mostro/settings.toml</code></td></tr>
    <tr><td>Base de datos</td><td><code>/opt/mostro/docker/config/mostro.db</code></td><td><code>~/mostro-config/mostro.db</code></td><td><code>/opt/mostro/mostro.db</code></td></tr>
    <tr><td>Cert LND</td><td><code>/opt/mostro/docker/config/lnd/tls.cert</code></td><td><code>~/mostro-config/lnd/tls.cert</code></td><td>Var√≠a (revisar config LND)</td></tr>
    <tr><td>Macaroon LND</td><td><code>/opt/mostro/docker/config/lnd/admin.macaroon</code></td><td><code>~/mostro-config/lnd/admin.macaroon</code></td><td>Var√≠a (revisar config LND)</td></tr>
    <tr><td>Archivo de servicio</td><td>N/A</td><td>N/A</td><td><code>/etc/systemd/system/mostro.service</code></td></tr>
    <tr><td>Logs</td><td><code>docker compose logs</code></td><td><code>docker logs -f mostro</code></td><td><code>journalctl -u mostro</code></td></tr>
  </tbody>
</table>
</div>

<h3>Comandos esenciales</h3>
<div class="code-block">
  <div class="code-block-header"><span>bash ‚Äî Docker</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>make docker-build          <span class="cm"># Construir/reconstruir</span>
make docker-up             <span class="cm"># Iniciar</span>
make docker-down           <span class="cm"># Detener</span>
docker compose logs -f     <span class="cm"># Ver logs</span></code></pre>
</div>

<div class="code-block">
  <div class="code-block-header"><span>bash ‚Äî Nativo</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>systemctl start mostro     <span class="cm"># Iniciar</span>
systemctl stop mostro      <span class="cm"># Detener</span>
systemctl restart mostro   <span class="cm"># Reiniciar</span>
systemctl status mostro    <span class="cm"># Ver estado</span>
journalctl -u mostro -f    <span class="cm"># Ver logs</span></code></pre>
</div>

<div class="code-block">
  <div class="code-block-header"><span>bash ‚Äî Base de datos</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>sqlite3 mostro.db "SELECT COUNT(*) FROM orders;"                           <span class="cm"># Total de √≥rdenes</span>
sqlite3 mostro.db "SELECT COUNT(*) FROM orders WHERE status='success';"    <span class="cm"># Operaciones exitosas</span>
sqlite3 mostro.db "SELECT SUM(fee*2) FROM orders WHERE status='success';"  <span class="cm"># Total de comisiones ganadas</span></code></pre>
</div>

<h3>Configuraci√≥n recomendada para nodos nuevos</h3>
<div class="code-block">
  <div class="code-block-header"><span>toml</span><button class="copy-btn" onclick="copyCode(this)" data-copy="Copiar" data-copied="¬°Copiado!">Copiar</button></div>
  <pre><code>[mostro]
fee = 0.006
max_order_amount = 500000
min_payment_amount = 1000
expiration_hours = 24
expiration_seconds = 900
pow = 0
dev_fee_percentage = 0.30
fiat_currencies_accepted = ['USD']  <span class="cm"># Cambia a tu moneda local</span>

[nostr]
relays = [
  'wss://relay.mostro.network',
  'wss://nos.lol',
  'wss://relay.nostr.band'
]</code></pre>
</div>

<!-- Footer -->
<div class="guide-footer">
  <p>Esta gu√≠a es mantenida por la comunidad Mostro. ¬øEncontraste un error o quieres mejorarla?<br>
  Las contribuciones son bienvenidas en <a href="https://github.com/MostroP2P/mostro" target="_blank" rel="noopener noreferrer">github.com/MostroP2P/mostro</a></p>
  <p style="margin-top:12px;">√öltima actualizaci√≥n: Febrero 2026 ¬∑ Mostro v0.16.3</p>
</div>

</main>

<button class="back-to-top" id="backToTop" onclick="window.scrollTo({top:0,behavior:'smooth'})">‚Üë</button>

<script src="guide.js"></script>

</body>
</html>
